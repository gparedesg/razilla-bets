(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"I/3d":function(t,e,n){"use strict";n.d(e,"a",function(){return sd});var r=n("fXoL"),i=n("D0XW"),o=n("HDdC"),s=n("Cfvw"),u=n("LRne"),a=n("JX91"),c=n("7o/Q");function h(){return t=>t.lift(new f)}class f{call(t,e){return e.subscribe(new l(t))}}class l extends c.a{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}var p=n("lJxs"),d=n("Kqap"),v=n("/uUt"),y=n("pLZG"),g=n("pxpQ"),b=n("spgP"),m=n("ofXK"),w=n("Jgta"),_=n("zIRd"),I=n("q/0M"),E=n("qOnz"),O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var j,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},S=N||self;function x(){}function D(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),C=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function R(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:R).apply(null,arguments)}function U(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function M(){return Date.now()}function q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++C)}(this)},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function Y(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Q,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:t>e?1:0}t:{var J=S.navigator;if(J){var Z=J.userAgent;if(Z){Q=Z;break t}}Q=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=x;var it,ot,st=X(Q,"Opera"),ut=X(Q,"Trident")||X(Q,"MSIE"),at=X(Q,"Edge"),ct=at||ut,ht=X(Q,"Gecko")&&!(X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge"))&&!(X(Q,"Trident")||X(Q,"MSIE"))&&!X(Q,"Edge"),ft=X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge");function lt(){var t=S.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=Q,ht?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var vt=lt();if(null!=vt&&vt>parseFloat(pt)){it=String(vt);break t}}it=pt}var yt={};function gt(t){return function(t,e){var n=yt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=K(String(it)).split("."),r=K(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=W(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||W(0==s[2].length,0==u[2].length)||W(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var bt=S.document&&ut&&(lt()||parseInt(it,10))||void 0,mt=!ut||9<=Number(bt),wt=ut&&!gt("9"),_t=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",x,e),S.removeEventListener("test",x,e)}catch(n){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{rt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ot[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},q(Et,It);var Ot={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),jt=0;function Nt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++jt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=z(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(At(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Nt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var kt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Ct(t,e,n,r,i){if(r&&r.once)return Rt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Tt]?t.va(e,n,k(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!mt)return null;var u=zt(t);if(u||(t[kt]=u=new St(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ft,e=mt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)_t||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Tt]?t.wa(e,n,k(r)?!!r.capture:!!r,i):Lt(t,e,n,!0,r,i)}function Vt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);else r=k(r)?!!r.capture:!!r,n=Bt(n),t&&t[Tt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Dt(o=t.a[e],n,r,i))&&(At(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=zt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Dt(e,n,r,i)),(n=-1<t?e[t]:null)&&Ut(n))}function Ut(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Tt])xt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=zt(e))?(xt(n,t),0==n.b&&(n.src=null,e[kt]=null)):At(t)}}}function Mt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function qt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(!mt){if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return qt(t,e=new Et(e,this))}return qt(t,new Et(e,this))}function zt(t){return(t=t[kt])instanceof St?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(t){return"function"==typeof t?t:(t[Gt]||(t[Gt]=function(e){return t.handleEvent(e)}),t[Gt])}function Yt(){F.call(this),this.c=new St(this),this.J=this,this.C=null}function Ht(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new It(e,t);else if(e instanceof It)e.target=e.target||t;else{var i=e;nt(e=new It(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Qt(s,r,!0,e)&&i}if(i=Qt(s=e.a=t,r,!0,e)&&i,i=Qt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Qt(s=e.a=n[o],r,!1,e)&&i}function Qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&xt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}q(Yt,F),Yt.prototype[Tt]=!0,(j=Yt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},j.removeEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},j.G=function(){if(Yt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},j.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},j.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=S.JSON.stringify;function Xt(){this.b=this.a=null}var Wt,Jt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new $t},function(t){t.reset()});function Zt(){var t=re,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function $t(){this.next=this.b=this.a=null}function te(t){S.setTimeout(function(){throw t},0)}function ee(t,e){Wt||function(){var t=S.Promise.resolve(void 0);Wt=function(){t.then(ie)}}(),ne||(Wt(),ne=!0),re.add(t,e)}Xt.prototype.add=function(t,e){var n=Jt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},$t.prototype.reset=function(){this.next=this.b=this.a=null};var ne=!1,re=new Xt;function ie(){for(var t;t=Zt();){try{t.a.call(t.b)}catch(n){te(n)}var e=Jt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ne=!1}function oe(t,e){Yt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=M()}function se(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ue(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}function ae(t){t.a=ue(function(){t.a=null,t.c&&(t.c=!1,ae(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}q(oe,Yt),(j=oe.prototype).aa=!1,j.M=null,j.Za=function(){if(this.aa){var t=M()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ht(this,"tick"),this.aa&&(se(this),this.start()))}},j.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},j.G=function(){oe.X.G.call(this),se(this),delete this.a};var ce=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:ae(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(F);function he(t){F.call(this),this.b=t,this.a={}}q(he,F);var fe=[];function le(t,e,n,r){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function de(){this.a=!0}function ve(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Kt(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.X.G.call(this),pe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ye={},ge=null;function be(){return ge=ge||new Yt}function me(t){It.call(this,ye.Fa,t)}function we(t){var e=be();Ht(e,new me(e,t))}function _e(t,e){It.call(this,ye.STAT_EVENT,t),this.stat=e}function Ie(t){var e=be();Ht(e,new _e(e,t))}function Ee(t){It.call(this,ye.Ga,t)}function Oe(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}ye.Fa="serverreachability",q(me,It),ye.STAT_EVENT="statevent",q(_e,It),ye.Ga="timingevent",q(Ee,It);var Te={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},je={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ne(){}function Ae(){}Ne.prototype.a=null;var Se,xe={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function De(){It.call(this,"d")}function ke(){It.call(this,"c")}function Pe(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new he(this),this.P=Le,this.R=new oe(t=ct?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}q(De,It),q(ke,It),q(Pe,Ne),Se=new Pe;var Le=45e3,Re={},Ve={};function Ue(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,Me(t,null)}function Me(t,e){t.u=M(),ze(t),t.l=tn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),wn(n.b,"t",r),t.D=0,t.a=dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ce(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Xa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function qe(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Fe(t,n);if(i==Ve){4==e&&(t.h=4,Ie(14),r=!1),ve(t.c,t.f,null,"[Incomplete Response]");break}if(i==Re){t.h=4,Ie(15),ve(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}ve(t.c,t.f,i,null),Qe(t,i)}4==e&&0==n.length&&(t.h=1,Ie(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),sr(e),e.F=!0,Ie(11))):(ve(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),Ye(t))}function Fe(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ve:(n=Number(e.substring(n,r)),isNaN(n)?Re:(r+=1)+n>e.length?Ve:(e=e.substr(r,n),t.D=r+n,e))}function ze(t){t.T=M()+t.P,Ge(t,t.P)}function Ge(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Oe(V(t.Va,t),e)}function Be(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Ye(t){0==t.g.v||t.A||cr(t.g,t)}function He(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,se(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Qe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Nn(n.b,t)))if(n.I=t.N,!t.C&&Nn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch($l){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;ar(n),Jn(n)}or(n),Ie(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Oe(V(n.Sa,n),6e3));if(1>=jn(n.b)&&n.ea){try{n.ea()}catch($l){}n.ea=void 0}}else fr(n,11)}else if((t.C||n.a==t)&&ar(n),!H(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(X(h,"spdy")||X(h,"quic")||X(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(An(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,sn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=M()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=pr(a,a.C?a.ga:null,a.fa),p.C){Sn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Be(d),ze(d)),a.a=p}else ir(a);0<n.g.length&&tr(n)}else"stop"!=i[0]&&"close"!=i[0]||fr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?fr(n,7):Wn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);we(4)}catch($l){}}function Ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(j=Ce.prototype).setTimeout=function(t){this.P=t},j.Xa=function(t){t=t.target;var e=this.F;e&&3==Hn(t)?e.f():this.Ca(t)},j.Ca=function(t){try{if(t==this.a)t:{var e=Hn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!ct&&!this.a.$())){this.A||4!=e||7==n||we(8==n||0>=r?3:2),Be(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ie(12),He(this),Ye(this);break t}ve(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Qe(this,a)}this.I?(qe(this,e,o),ct&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Wa),this.R.start())):(ve(this.c,this.f,o,null),Qe(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?cr(this.g,this):(this.b=!1,ze(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ie(12)):(this.h=0,Ie(13)),He(this),Ye(this)}}}catch(c){}},j.Wa=function(){if(this.a){var t=Hn(this.a),e=this.a.$();this.D<e.length&&(Be(this),qe(this,t,e),this.b&&4!=t&&ze(this))}},j.cancel=function(){this.A=!0,He(this)},j.Va=function(){this.o=null;var t=M();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(we(3),Ie(17)),He(this),this.h=2,Ye(this)):Ge(this,this.T-t)},(j=Xe.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},j.L=function(){return We(this),this.a.concat()},j.get=function(t,e){return Je(this.b,t)?this.b[t]:e},j.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},j.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e){this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b;var n=new yn;n.c=e.c,e.a&&(n.a=new Xe(e.a),n.b=e.b),on(this,n),this.i=t.i}else t&&(n=String(t).match(Ze))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){e instanceof yn?(t.b=e,function(t,e){e&&!t.f&&(gn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(bn(this,e),wn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=cn(e,dn)),t.b=new yn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,vn)),t.join("")};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,vn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(t){t.a||(t.a=new Xe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function bn(t,e){gn(t),e=_n(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function mn(t,e){return gn(t),e=_n(t,e),Je(t.a.b,e)}function wn(t,e,n){bn(t,e),0<n.length&&(t.c=null,t.a.set(_n(t,e),Y(n)),t.b+=n.length)}function _n(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(j=yn.prototype).add=function(t,e){gn(this),this.c=null,t=_n(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},j.forEach=function(t,e){gn(this),this.a.forEach(function(n,r){G(n,function(n){t.call(e,n,r,this)},this)},this)},j.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},j.K=function(t){gn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=B(e,this.a.get(_n(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},j.set=function(t,e){return gn(this),this.c=null,mn(this,t=_n(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},j.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},j.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var In=function(){return function(t,e){this.b=t,this.a=e}}();function En(t){this.g=t||On,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var On=10;function Tn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function jn(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function xn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Y(t.c)}function Dn(){}function kn(){this.a=new Dn}function Pn(t,e,n){var r=n||"";try{Ke(t,function(t,n){var i=t;k(t)&&(i=Kt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(qp){throw e.push(r+"type="+encodeURIComponent("_badmap")),qp}}function Cn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}En.prototype.cancel=function(){var t,e;if(this.c=xn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Ln=S.JSON.parse;function Rn(t){Yt.call(this),this.headers=new Xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}q(Rn,Yt);var Vn="",Un=/^https?$/i,Mn=["POST","PUT"];function qn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,zn(t),Bn(t)}function zn(t){t.u||(t.u=!0,Ht(t,"complete"),Ht(t,"error"))}function Gn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Hn(t)||2!=t.W()))if(t.l&&4==Hn(t))ue(t.za,0,t);else if(Ht(t,"readystatechange"),4==Hn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ze)[1]||null;if(!o&&S.self&&S.self.location){var s=S.self.location.protocol;o=s.substr(0,s.length-1)}i=!Un.test(o?o.toLowerCase():"")}e=i}if(e)Ht(t,"complete"),Ht(t,"success");else{t.h=6;try{var u=2<Hn(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",zn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Yn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||Ht(t,"ready");try{n.onreadystatechange=r}catch(qp){}}}function Yn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Hn(t){return t.a?t.a.readyState:0}function Qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return $(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Kn("baseRetryDelayMs",5e3,t),this.Ra=Kn("retryDelaySeedMs",1e4,t),this.Ma=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Wn(t){if(Zn(t),3==t.v){var e=t.R++,n=tn(t.B);sn(n,"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),nr(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=dr(e.g,null),e.a.ba(e.i)),e.u=M(),ze(e)}lr(t)}function Jn(t){t.a&&(sr(t),t.a.cancel(),t.a=null)}function Zn(t){Jn(t),t.j&&(S.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new In(t.Oa++,e)),3==t.v&&tr(t)}function tr(t){Tn(t.b)||t.h||(t.h=!0,ee(t.Ba,t),t.u=0)}function er(t,e){var n;n=e?e.f:t.R++;var r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),nr(t,r),t.i&&t.l&&Qn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ue(n,r,e)}function nr(t,e){t.f&&Ke({},function(t,n){sn(e,n,t)})}function rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{Pn(h,s,"req"+c+"_")}catch(Wr){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ir(t){t.a||t.j||(t.T=1,ee(t.Aa,t),t.o=0)}function or(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Oe(V(t.Aa,t),hr(t,t.o)),t.o++,0))}function sr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function ur(t){t.a=new Ce(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),nr(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,Me(n,t)}function ar(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function cr(t,e){var n=null;if(t.a==e){ar(t),sr(t),t.a=null;var r=2}else{if(!Nn(t.b,e))return;n=e.s,Sn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=M()-e.u;var i=t.u;Ht(r=be(),new Ee(r,n,e,i)),tr(t)}else ir(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(jn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Oe(V(t.Ba,t,e),hr(t,t.u)),t.u++,0)))}(t,e)||2==r&&or(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:fr(t,5);break;case 4:fr(t,10);break;case 3:fr(t,6);break;default:fr(t,2)}}function hr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function fr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=V(t.Ya,t);n||(n=new $e("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||en(n,"https"),un(n)),function(t,e){var n=new de;if(S.Image){var r=new Image;r.onload=U(Cn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=U(Cn,n,r,"TestLoadImage: error",!1,e),r.onabort=U(Cn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=U(Cn,n,r,"TestLoadImage: timeout",!1,e),S.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ie(2);t.v=0,t.f&&t.f.ra(e),lr(t),Zn(t)}function lr(t){t.v=0,t.I=-1,t.f&&(0==xn(t.b).length&&0==t.g.length||(t.b.c.length=0,Y(t.g),t.g.length=0),t.f.qa())}function pr(t,e,n){var r=function(t){return t instanceof $e?tn(t):new $e(t,void 0)}(n);if(""!=r.c)e&&nn(r,e+"."+r.c),rn(r,r.h);else{var i=S.location;r=function(t,e,n,r){var i=new $e(null,void 0);return t&&en(i,t),e&&nn(i,e),n&&rn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&$(t.V,function(t,e){sn(r,e,t)}),n=t.na,(e=t.A)&&n&&sn(r,e,n),sn(r,"VER",t.ha),nr(t,r),r}function dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Na)).F=t.C,e}function vr(){}function yr(){if(ut&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function gr(t,e){Yt.call(this),this.a=new Xn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function br(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){ke.call(this),this.status=1}function wr(t){this.a=t}(j=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:Se),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Fn(this,o)}t=n||"";var i=new Xe(this.headers);r&&Ke(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=qn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=S.FormData&&t instanceof S.FormData,!(0<=z(Mn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Yn(this),0<this.o&&((this.D=function(t){return ut&&gt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ue(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Fn(this,o)}},j.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ht(this,"timeout"),this.abort(8))},j.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ht(this,"complete"),Ht(this,"abort"),Bn(this))},j.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Rn.X.G.call(this)},j.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ua())},j.Ua=function(){Gn(this)},j.W=function(){try{return 2<Hn(this)?this.a.status:-1}catch(ot){return-1}},j.$=function(){try{return this.a?this.a.responseText:""}catch(ot){return""}},j.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},j.ua=function(){return this.h},j.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(j=Xn.prototype).ha=8,j.v=1,j.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),nr(this,i),this.i&&r&&Qn(i,this.i,r),An(this.b,n),this.Ia&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.U=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?er(this,t):0==this.g.length||Tn(this.b)||er(this))},j.Aa=function(){if(this.j=null,ur(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Oe(V(this.Ta,this),t)}},j.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Ie(10),Jn(this),ur(this))},j.Sa=function(){null!=this.m&&(this.m=null,Jn(this),or(this),Ie(19))},j.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Ie(2)):(this.c.info("Failed to ping google.com"),Ie(1))},(j=vr.prototype).ta=function(){},j.sa=function(){},j.ra=function(){},j.qa=function(){},j.Ja=function(){},yr.prototype.a=function(t,e){return new gr(t,e)},q(gr,Yt),gr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Ie(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=pr(t,null,t.fa),tr(t)},gr.prototype.close=function(){Wn(this.a)},gr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,$n(this.a,e)}else this.l?((e={}).__data__=Kt(t),$n(this.a,e)):$n(this.a,t)},gr.prototype.G=function(){this.a.f=null,delete this.f,Wn(this.a),delete this.a,gr.X.G.call(this)},q(br,De),q(mr,ke),q(wr,vr),wr.prototype.ta=function(){Ht(this.a,"a")},wr.prototype.sa=function(t){Ht(this.a,new br(t))},wr.prototype.ra=function(t){Ht(this.a,new mr(t))},wr.prototype.qa=function(){Ht(this.a,"b")},yr.prototype.createWebChannel=yr.prototype.a,gr.prototype.send=gr.prototype.h,gr.prototype.open=gr.prototype.g,gr.prototype.close=gr.prototype.close,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,je.COMPLETE="complete",Ae.EventType=xe,xe.OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",Yt.prototype.listen=Yt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.W,Rn.prototype.getResponseJson=Rn.prototype.Pa,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var _r=Te,Ir=je,Er=ye,Or=Ae,Tr=Rn,jr=n("30Go"),Nr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ar=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Sr=new I.b("@firebase/firestore");function xr(){return Sr.logLevel}function Dr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sr.logLevel<=I.a.DEBUG){var r=e.map(Cr);Sr.debug.apply(Sr,Object(jr.g)(["Firestore (8.2.6): "+t],r))}}function kr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sr.logLevel<=I.a.ERROR){var r=e.map(Cr);Sr.error.apply(Sr,Object(jr.g)(["Firestore (8.2.6): "+t],r))}}function Pr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sr.logLevel<=I.a.WARN){var r=e.map(Cr);Sr.warn.apply(Sr,Object(jr.g)(["Firestore (8.2.6): "+t],r))}}function Cr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(qp){return t}}function Lr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.6) INTERNAL ASSERTION FAILED: "+t;throw kr(e),new Error(e)}function Rr(t,e){t||Lr()}function Vr(t,e){return t}function Ur(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Mr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ur(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function qr(t,e){return t<e?-1:t>e?1:0}function Fr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function zr(t){return t+"\0"}var Gr=function(){function t(t){this.h=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.h)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},t.prototype.l=function(){return 2*this.h.length},t.prototype._=function(t){return qr(this.h,t.h)},t.prototype.isEqual=function(t){return this.h===t.h},t}();Gr.T=new Gr("");var Br={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(jr.c)(e,t),e}(Error),Hr=function(){function t(t){this.I=t}return t.fromBase64String=function(e){try{return new t(Gr.fromBase64String(e))}catch(e){throw new Yr(Br.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Gr.fromUint8Array(e))},t.prototype.toBase64=function(){return this.I.toBase64()},t.prototype.toUint8Array=function(){return this.I.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.I.isEqual(t.I)},t}(),Qr=function(){function t(t){this.uid=t}return t.prototype.m=function(){return null!=this.uid},t.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Qr.UNAUTHENTICATED=new Qr(null),Qr.R=new Qr("google-credentials-uid"),Qr.P=new Qr("first-party-uid");var Kr=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},Xr=function(){function t(){this.V=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.p=function(){},t.prototype.v=function(t){this.V=t,t(Qr.UNAUTHENTICATED)},t.prototype.S=function(){this.V=null},t}(),Wr=function(){function t(t){var e=this;this.D=null,this.currentUser=Qr.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.F(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.N!==e?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Rr("string"==typeof n.accessToken),new Kr(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.p=function(){this.forceRefresh=!0},t.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},t.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new Qr(t)},t}(),Jr=function(){function t(t,e){this.O=t,this.k=e,this.type="FirstParty",this.user=Qr.P}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.k},e=this.O.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Zr=function(){function t(t,e){this.O=t,this.k=e}return t.prototype.getToken=function(){return Promise.resolve(new Jr(this.O,this.k))},t.prototype.v=function(t){t(Qr.P)},t.prototype.S=function(){},t.prototype.p=function(){},t}(),$r=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.M=function(t){return n.L(t)},this.$=function(t){return e.B(t)})}return t.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.$&&this.$(t),t},t}();$r.q=-1;var ti=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Yr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Yr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Yr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?qr(this.nanoseconds,t.nanoseconds):qr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ei=function(){function t(t){this.timestamp=t}return t.K=function(e){return new t(e)},t.min=function(){return new t(new ti(0,0))},t.prototype._=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.j=function(){return this.timestamp},t}(),ni=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.G=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.H(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.J(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Y=function(t){return this.J(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},t.prototype.Z=function(){return this.segments[this.offset]},t.prototype.tt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.et=function(){return 0===this.length},t.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},t.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.prototype.rt=function(){return this.it().join("/")},e.prototype.toString=function(){return this.rt()},e.ot=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Yr(Br.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.ct=function(){return new e([])},e}(ni),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.at=function(t){return ii.test(t)},e.prototype.rt=function(){return this.it().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.at(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.rt()},e.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},e.ht=function(){return new e(["__name__"])},e.lt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Yr(Br.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Yr(Br.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Yr(Br.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Yr(Br.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.ct=function(){return new e([])},e}(ni),si=function(){function t(t){this.path=t}return t._t=function(e){return new t(ri.ot(e))},t.ft=function(e){return new t(ri.ot(e).Y(5))},t.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ri.H(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.H=function(t,e){return ri.H(t.path,e.path)},t.wt=function(t){return t.length%2==0},t.Et=function(e){return new t(new ri(e.slice()))},t}();function ui(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ai(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ci(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var hi=function(){function t(t){this.fields=t,t.sort(oi.H)}return t.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},t.prototype.isEqual=function(t){return Fr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),fi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(Rr(!!t),"string"==typeof t){var e=0,n=fi.exec(t);if(Rr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:pi(t.seconds),nanos:pi(t.nanos)}}function pi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function di(t){return"string"==typeof t?Gr.fromBase64String(t):Gr.fromUint8Array(t)}function vi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yi(t){var e=t.mapValue.fields.__previous_value__;return vi(e)?yi(e):e}function gi(t){var e=li(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(e.seconds,e.nanos)}function bi(t){return null==t}function mi(t){return 0===t&&1/t==-1/0}function wi(t){return"number"==typeof t&&Number.isInteger(t)&&!mi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function _i(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vi(t)?4:10:Lr()}function Ii(t,e){var n=_i(t);if(n!==_i(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gi(t).isEqual(gi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=li(t.timestampValue),r=li(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return di(t.bytesValue).isEqual(di(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return pi(t.geoPointValue.latitude)===pi(e.geoPointValue.latitude)&&pi(t.geoPointValue.longitude)===pi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return pi(t.integerValue)===pi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=pi(t.doubleValue),r=pi(e.doubleValue);return n===r?mi(n)===mi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Fr(t.arrayValue.values||[],e.arrayValue.values||[],Ii);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ui(n)!==ui(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ii(n[i],r[i])))return!1;return!0}(t,e);default:return Lr()}}function Ei(t,e){return void 0!==(t.values||[]).find(function(t){return Ii(t,e)})}function Oi(t,e){var n=_i(t),r=_i(e);if(n!==r)return qr(n,r);switch(n){case 0:return 0;case 1:return qr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=pi(t.integerValue||t.doubleValue),r=pi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ti(t.timestampValue,e.timestampValue);case 4:return Ti(gi(t),gi(e));case 5:return qr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=di(t),r=di(e);return n._(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=qr(n[i],r[i]);if(0!==o)return o}return qr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=qr(pi(t.latitude),pi(e.latitude));return 0!==n?n:qr(pi(t.longitude),pi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Oi(n[i],r[i]);if(o)return o}return qr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=qr(r[s],o[s]);if(0!==u)return u;var a=Oi(n[r[s]],i[o[s]]);if(0!==a)return a}return qr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function Ti(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qr(t,e);var n=li(t),r=li(e),i=qr(n.seconds,r.seconds);return 0!==i?i:qr(n.nanos,r.nanos)}function ji(t){return Ni(t)}function Ni(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=li(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?di(t.bytesValue).toBase64():"referenceValue"in t?si.ft(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ni(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ni(t.fields[o])}return e+"}"}(t.mapValue):Lr();var e}function Ai(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function Si(t){return!!t&&"integerValue"in t}function xi(t){return!!t&&"arrayValue"in t}function Di(t){return!!t&&"nullValue"in t}function ki(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pi(t){return!!t&&"mapValue"in t}var Ci=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Pi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},t.prototype.isEqual=function(t){return Ii(this.proto,t.proto)},t}(),Li=function(){function t(t){void 0===t&&(t=Ci.empty()),this.It=t,this.At=new Map}return t.prototype.set=function(t,e){return this.Rt(t,e),this},t.prototype.delete=function(t){return this.Rt(t,null),this},t.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===_i(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.tt(),e)},t.prototype.Pt=function(){var t=this.yt(oi.ct(),this.At);return null!=t?new Ci(t):this.It},t.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=Pi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.yt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Ri(t){var e=[];return ai(t.fields||{},function(t,n){var r=new oi([t]);if(Pi(n)){var i=Ri(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new hi(e)}var Vi=function(t,e){this.key=t,this.version=e},Ui=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).gt=r,o.Vt=!!i.Vt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(jr.c)(e,t),e.prototype.field=function(t){return this.gt.field(t)},e.prototype.data=function(){return this.gt},e.prototype.bt=function(){return this.gt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Vi),Mi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(jr.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Vi),qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Vi),Fi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function zi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Fi(t,e,n,r,i,o,s)}function Gi(t){var e=Vr(t);if(null===e.vt){var n=e.path.rt();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.rt()+t.op.toString()+ji(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.rt()+t.dir}(t)}).join(","),bi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=no(e.startAt)),e.endAt&&(n+="|ub:",n+=no(e.endAt)),e.vt=n}return e.vt}function Bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!io(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Ii(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!so(t.startAt,e.startAt)&&so(t.endAt,e.endAt)}function Yi(t){return si.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Hi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(jr.c)(e,t),e.create=function(t,n,r){return t.ut()?"in"===n||"not-in"===n?this.St(t,n,r):new Qi(t,n,r):"array-contains"===n?new Ji(t,r):"in"===n?new Zi(t,r):"not-in"===n?new $i(t,r):"array-contains-any"===n?new to(t,r):new e(t,n,r)},e.St=function(t,e,n){return"in"===e?new Ki(t,n):new Xi(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Dt(Oi(e,this.value)):null!==e&&_i(this.value)===_i(e)&&this.Dt(Oi(e,this.value))},e.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Lr()}},e.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Qi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=si.ft(r.referenceValue),i}return Object(jr.c)(e,t),e.prototype.matches=function(t){var e=si.H(t.key,this.key);return this.Dt(e)},e}(Hi),Ki=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Wi(0,n),r}return Object(jr.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Hi),Xi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Wi(0,n),r}return Object(jr.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Hi);function Wi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return si.ft(t.referenceValue)})}var Ji=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(jr.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return xi(e)&&Ei(e.arrayValue,this.value)},e}(Hi),Zi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(jr.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ei(this.value.arrayValue,e)},e}(Hi),$i=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(jr.c)(e,t),e.prototype.matches=function(t){if(Ei(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ei(this.value.arrayValue,e)},e}(Hi),to=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(jr.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!xi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ei(e.value.arrayValue,t)})},e}(Hi),eo=function(t,e){this.position=t,this.before=e};function no(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return ji(t)}).join(",")}var ro=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function io(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function oo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ut()?si.H(si.ft(s.referenceValue),n.key):Oi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function so(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ii(t.position[n],e.position[n]))return!1;return!0}var uo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.Ft=null};function ao(t,e,n,r,i,o,s,u){return new uo(t,e,n,r,i,o,s,u)}function co(t){return new uo(t)}function ho(t){return!bi(t.limit)&&"F"===t.limitType}function fo(t){return!bi(t.limit)&&"L"===t.limitType}function lo(t){return t.xt.length>0?t.xt[0].field:null}function po(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function vo(t){return null!==t.collectionGroup}function yo(t){var e=Vr(t);if(null===e.Nt){e.Nt=[];var n=po(e),r=lo(e);if(null!==n&&null===r)n.ut()||e.Nt.push(new ro(n)),e.Nt.push(new ro(oi.ht(),"asc"));else{for(var i=!1,o=0,s=e.xt;o<s.length;o++){var u=s[o];e.Nt.push(u),u.field.ut()&&(i=!0)}if(!i){var a=e.xt.length>0?e.xt[e.xt.length-1].dir:"asc";e.Nt.push(new ro(oi.ht(),a))}}}return e.Nt}function go(t){var e=Vr(t);if(!e.Ft)if("F"===e.limitType)e.Ft=zi(e.path,e.collectionGroup,yo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yo(e);r<i.length;r++){var o=i[r];n.push(new ro(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new eo(e.endAt.position,!e.endAt.before):null,u=e.startAt?new eo(e.startAt.position,!e.startAt.before):null;e.Ft=zi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ft}function bo(t,e,n){return new uo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mo(t,e){return Bi(go(t),go(e))&&t.limitType===e.limitType}function wo(t){return Gi(go(t))+"|lt:"+t.limitType}function _o(t){return"Query(target="+function(t){var e=t.path.rt();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.rt()+" "+e.op+" "+ji(e.value);var e}).join(", ")+"]"),bi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.rt()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+no(t.startAt)),t.endAt&&(e+=", endAt: "+no(t.endAt)),"Target("+e+")"}(go(t))+"; limitType="+t.limitType+")"}function Io(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.dt(t.collectionGroup)&&t.path.nt(n):si.wt(t.path)?t.path.isEqual(n):t.path.st(n)}(t,e)&&function(t,e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!oo(t.startAt,yo(t),e)||t.endAt&&oo(t.endAt,yo(t),e))}(t,e)}function Eo(t){return function(e,n){for(var r=!1,i=0,o=yo(t);i<o.length;i++){var s=o[i],u=Oo(s,e,n);if(0!==u)return u;r=r||s.field.ut()}return 0}}function Oo(t,e,n){var r=t.field.ut()?si.H(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Oi(r,i):Lr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Lr()}}var To=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===s&&(s=Gr.T),this.target=t,this.targetId=e,this.Ot=n,this.sequenceNumber=r,this.kt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Mt=function(e){return new t(this.target,this.targetId,this.Ot,e,this.kt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.Lt=function(e,n){return new t(this.target,this.targetId,this.Ot,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.$t=function(e){return new t(this.target,this.targetId,this.Ot,this.sequenceNumber,this.kt,e,this.resumeToken)},t}();function jo(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mi(e)?"-0":e}}function No(t){return{integerValue:""+t}}function Ao(t,e){return wi(e)?No(e):jo(t,e)}var So=function(){this.qt=void 0};function xo(t,e,n){return t instanceof Po?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Co?Lo(t,e):t instanceof Ro?Vo(t,e):function(t,e){var n=ko(t,e),r=Mo(n)+Mo(t.Ut);return Si(n)&&Si(t.Ut)?No(r):jo(t.Qt,r)}(t,e)}function Do(t,e,n){return t instanceof Co?Lo(t,e):t instanceof Ro?Vo(t,e):n}function ko(t,e){return t instanceof Uo?Si(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e}(So),Co=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(jr.c)(e,t),e}(So);function Lo(t,e){for(var n=qo(e),r=function(t){n.some(function(e){return Ii(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ro=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(jr.c)(e,t),e}(So);function Vo(t,e){for(var n=qo(e),r=function(t){n=n.filter(function(e){return!Ii(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Uo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.Ut=n,r}return Object(jr.c)(e,t),e}(So);function Mo(t){return pi(t.integerValue||t.doubleValue)}function qo(t){return xi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Fo=function(t,e){this.field=t,this.transform=e},zo=function(t,e){this.version=t,this.transformResults=e},Go=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Kt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Bo(t,e){return void 0!==t.updateTime?e instanceof Ui&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ui}var Yo=function(){};function Ho(t,e,n){return t instanceof Jo?function(t,e,n){var r=t.value;if(n.transformResults){var i=ts(t.fieldTransforms,e,n.transformResults);r=ns(t.fieldTransforms,r,i)}return new Ui(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Zo?function(t,e,n){if(!Bo(t.jt,e))return new qi(t.key,n.version);var r=$o(t,e,n.transformResults?ts(t.fieldTransforms,e,n.transformResults):[]);return new Ui(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Mi(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Qo(t,e,n){return t instanceof Jo?function(t,e,n){if(!Bo(t.jt,e))return e;var r=t.value,i=es(t.fieldTransforms,n,e);r=ns(t.fieldTransforms,r,i);var o=Wo(e);return new Ui(t.key,o,r,{Vt:!0})}(t,e,n):t instanceof Zo?function(t,e,n){if(!Bo(t.jt,e))return e;var r=Wo(e),i=$o(t,e,es(t.fieldTransforms,n,e));return new Ui(t.key,r,i,{Vt:!0})}(t,e,n):function(t,e){return Bo(t.jt,e)?new Mi(t.key,ei.min()):e}(t,e)}function Ko(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Ui?e.field(o.field):void 0,u=ko(o.transform,s||null);null!=u&&(n=null==n?(new Li).set(o.field,u):n.set(o.field,u))}return n?n.Pt():null}(t.fieldTransforms,e)}function Xo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Fr(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Co&&e instanceof Co||t instanceof Ro&&e instanceof Ro?Fr(t.elements,e.elements,Ii):t instanceof Uo&&e instanceof Uo?Ii(t.Ut,e.Ut):t instanceof Po&&e instanceof Po}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt))}function Wo(t){return t instanceof Ui?t.version:ei.min()}var Jo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.jt=r,o.fieldTransforms=i,o.type=0,o}return Object(jr.c)(e,t),e}(Yo),Zo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.Gt=r,s.jt=i,s.fieldTransforms=o,s.type=1,s}return Object(jr.c)(e,t),e}(Yo);function $o(t,e,n){var r;return r=function(t,e){var n=new Li(e);return t.Gt.fields.forEach(function(e){if(!e.et()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.Pt()}(t,r=e instanceof Ui?e.data():Ci.empty()),ns(t.fieldTransforms,r,n)}function ts(t,e,n){var r=[];Rr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ui&&(u=e.field(o.field)),r.push(Do(s,u,n[i]))}return r}function es(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i],u=s.transform,a=null;n instanceof Ui&&(a=n.field(s.field)),r.push(xo(u,a,e))}return r}function ns(t,e,n){for(var r=new Li(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.Pt()}var rs,is,os=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=2,r.fieldTransforms=[],r}return Object(jr.c)(e,t),e}(Yo),ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=3,r.fieldTransforms=[],r}return Object(jr.c)(e,t),e}(Yo),us=function(t){this.count=t};function as(t){switch(t){case Br.OK:return Lr();case Br.CANCELLED:case Br.UNKNOWN:case Br.DEADLINE_EXCEEDED:case Br.RESOURCE_EXHAUSTED:case Br.INTERNAL:case Br.UNAVAILABLE:case Br.UNAUTHENTICATED:return!1;case Br.INVALID_ARGUMENT:case Br.NOT_FOUND:case Br.ALREADY_EXISTS:case Br.PERMISSION_DENIED:case Br.FAILED_PRECONDITION:case Br.ABORTED:case Br.OUT_OF_RANGE:case Br.UNIMPLEMENTED:case Br.DATA_LOSS:return!0;default:return Lr()}}function cs(t){if(void 0===t)return kr("GRPC error has no .code"),Br.UNKNOWN;switch(t){case rs.OK:return Br.OK;case rs.CANCELLED:return Br.CANCELLED;case rs.UNKNOWN:return Br.UNKNOWN;case rs.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case rs.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case rs.INTERNAL:return Br.INTERNAL;case rs.UNAVAILABLE:return Br.UNAVAILABLE;case rs.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case rs.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case rs.NOT_FOUND:return Br.NOT_FOUND;case rs.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case rs.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case rs.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case rs.ABORTED:return Br.ABORTED;case rs.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case rs.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case rs.DATA_LOSS:return Br.DATA_LOSS;default:return Lr()}}(is=rs||(rs={}))[is.OK=0]="OK",is[is.CANCELLED=1]="CANCELLED",is[is.UNKNOWN=2]="UNKNOWN",is[is.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",is[is.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",is[is.NOT_FOUND=5]="NOT_FOUND",is[is.ALREADY_EXISTS=6]="ALREADY_EXISTS",is[is.PERMISSION_DENIED=7]="PERMISSION_DENIED",is[is.UNAUTHENTICATED=16]="UNAUTHENTICATED",is[is.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",is[is.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",is[is.ABORTED=10]="ABORTED",is[is.OUT_OF_RANGE=11]="OUT_OF_RANGE",is[is.UNIMPLEMENTED=12]="UNIMPLEMENTED",is[is.INTERNAL=13]="INTERNAL",is[is.UNAVAILABLE=14]="UNAVAILABLE",is[is.DATA_LOSS=15]="DATA_LOSS";var hs=function(){function t(t,e){this.H=t,this.root=e||ls.EMPTY}return t.prototype.zt=function(e,n){return new t(this.H,this.root.zt(e,n,this.H).copy(null,null,ls.Ht,null,null))},t.prototype.remove=function(e){return new t(this.H,this.root.remove(e,this.H).copy(null,null,ls.Ht,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.et=function(){return this.root.et()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Jt=function(){return this.root.Jt()},t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(t){return this.root.Xt(t)},t.prototype.forEach=function(t){this.Xt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Xt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.te=function(){return new fs(this.root,null,this.H,!1)},t.prototype.ee=function(t){return new fs(this.root,t,this.H,!1)},t.prototype.ne=function(){return new fs(this.root,null,this.H,!0)},t.prototype.se=function(t){return new fs(this.root,t,this.H,!0)},t}(),fs=function(){function t(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return t.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},t.prototype.ce=function(){return this.re.length>0},t.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},t}(),ls=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.et=function(){return!1},t.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},t.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},t.prototype.min=function(){return this.left.et()?this:this.left.min()},t.prototype.Jt=function(){return this.min().key},t.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},t.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},t.prototype.he=function(){if(this.left.et())return t.EMPTY;var e=this;return e.left.le()||e.left.left.le()||(e=e._e()),(e=e.copy(null,null,null,e.left.he(),null)).ue()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),0===n(e,i.key)){if(i.right.et())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.ue()},t.prototype.le=function(){return this.color},t.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},t.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},t.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},t.prototype.we=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.fe=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},t.prototype.Ie=function(){if(this.le()&&this.left.le())throw Lr();if(this.right.le())throw Lr();var t=this.left.Ie();if(t!==this.right.Ie())throw Lr();return t+(this.le()?0:1)},t}();ls.EMPTY=null,ls.RED=!0,ls.Ht=!1,ls.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.zt=function(t,e,n){return new ls(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.et=function(){return!0},t.prototype.Xt=function(t){return!1},t.prototype.Zt=function(t){return!1},t.prototype.Jt=function(){return null},t.prototype.Yt=function(){return null},t.prototype.le=function(){return!1},t.prototype.Te=function(){return!0},t.prototype.Ie=function(){return 0},t}());var ps=function(){function t(t){this.H=t,this.data=new hs(this.H)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Jt()},t.prototype.last=function(){return this.data.Yt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Xt(function(e,n){return t(e),!1})},t.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(this.H(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ae=function(t,e){var n;for(n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},t.prototype.Re=function(t){var e=this.data.ee(t);return e.ce()?e.oe().key:null},t.prototype.te=function(){return new ds(this.data.te())},t.prototype.ee=function(t){return new ds(this.data.ee(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.et=function(){return this.data.et()},t.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.te(),r=e.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(0!==this.H(i,o))return!1}return!0},t.prototype.it=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.H);return n.data=e,n},t}(),ds=function(){function t(t){this.ye=t}return t.prototype.oe=function(){return this.ye.oe().key},t.prototype.ce=function(){return this.ye.ce()},t}(),vs=new hs(si.H);function ys(){return vs}function gs(){return ys()}var bs=new hs(si.H);function ms(){return bs}var ws=new hs(si.H);function _s(){return ws}var Is=new ps(si.H);function Es(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Is,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Os=new ps(qr);function Ts(){return Os}var js=function(){function t(t){this.H=t?function(e,n){return t(e,n)||si.H(e.key,n.key)}:function(t,e){return si.H(t.key,e.key)},this.ge=ms(),this.Ve=new hs(this.H)}return t.pe=function(e){return new t(e.H)},t.prototype.has=function(t){return null!=this.ge.get(t)},t.prototype.get=function(t){return this.ge.get(t)},t.prototype.first=function(){return this.Ve.Jt()},t.prototype.last=function(){return this.Ve.Yt()},t.prototype.et=function(){return this.Ve.et()},t.prototype.indexOf=function(t){var e=this.ge.get(t);return e?this.Ve.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ve.Xt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ve.te(),r=e.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.H=this.H,r.ge=e,r.Ve=n,r},t}(),Ns=function(){function t(){this.be=new hs(si.H)}return t.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);n?0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Lr():this.be=this.be.zt(e,t)},t.prototype.ve=function(){var t=[];return this.be.Xt(function(e,n){t.push(n)}),t},t}(),As=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}return t.Ne=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,js.pe(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&mo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ss=function(){function t(t,e,n,r,i){this.kt=t,this.Fe=e,this.Oe=n,this.ke=r,this.Me=i}return t.Le=function(e,n){var r=new Map;return r.set(e,xs.$e(e,n)),new t(ei.min(),r,Ts(),ys(),Es())},t}(),xs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}return t.$e=function(e,n){return new t(Gr.T,n,Es(),Es(),Es())},t}(),Ds=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},ks=function(t,e){this.targetId=t,this.je=e},Ps=function(t,e,n,r){void 0===n&&(n=Gr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Cs=function(){function t(){this.Ge=0,this.ze=Vs(),this.He=Gr.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(t.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),t.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},t.prototype.en=function(){var t=Es(),e=Es(),n=Es();return this.ze.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Lr()}}),new xs(this.He,this.Je,t,e,n)},t.prototype.nn=function(){this.Ye=!1,this.ze=Vs()},t.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},t.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},t.prototype.on=function(){this.Ge+=1},t.prototype.cn=function(){this.Ge-=1},t.prototype.an=function(){this.Ye=!0,this.Je=!0},t}(),Ls=function(){function t(t){this.un=t,this.hn=new Map,this.ln=ys(),this._n=Rs(),this.fn=new ps(qr)}return t.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Ui?this.wn(r,t.We):t.We instanceof Mi&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.En(r=o[i],t.key,t.We)},t.prototype.Tn=function(t){var e=this;this.In(t,function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:Lr()}})},t.prototype.In=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.hn.forEach(function(t,r){n.An(r)&&e(r)})},t.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,r=this.yn(e);if(r){var i=r.target;if(Yi(i))if(0===n){var o=new si(i.path);this.En(e,o,new Mi(o,ei.min()))}else Rr(1===n);else this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e))}},t.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach(function(r,i){var o=e.yn(i);if(o){if(r.Be&&Yi(o.target)){var s=new si(o.target.path);null!==e.ln.get(s)||e.pn(i,s)||e.En(i,s,new Mi(s,t))}r.Ze&&(n.set(i,r.en()),r.nn())}});var r=Es();this._n.forEach(function(t,n){var i=!0;n.Ae(function(t){var n=e.yn(t);return!n||2===n.Ot||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Ss(t,n,this.fn,this.ln,r);return this.ln=ys(),this._n=Rs(),this.fn=new ps(qr),i},t.prototype.wn=function(t,e){if(this.An(t)){var n=this.pn(t,e.key)?2:0;this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t))}},t.prototype.En=function(t,e,n){if(this.An(t)){var r=this.mn(t);this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n))}},t.prototype.removeTarget=function(t){this.hn.delete(t)},t.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},t.prototype.on=function(t){this.mn(t).on()},t.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new Cs,this.hn.set(t,e)),e},t.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new ps(qr),this._n=this._n.zt(t,e)),e},t.prototype.An=function(t){var e=null!==this.yn(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},t.prototype.Rn=function(t){var e=this;this.hn.set(t,new Cs),this.un.vn(t).forEach(function(n){e.En(t,n,null)})},t.prototype.pn=function(t,e){return this.un.vn(t).has(e)},t}();function Rs(){return new hs(si.H)}function Vs(){return new hs(si.H)}var Us={asc:"ASCENDING",desc:"DESCENDING"},Ms={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qs=function(t,e){this.t=t,this.Bt=e};function Fs(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function zs(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Gs(t,e){return Fs(t,e.j())}function Bs(t){return Rr(!!t),ei.K(function(t){var e=li(t);return new ti(e.seconds,e.nanos)}(t))}function Ys(t,e){return function(t){return new ri(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).rt()}function Hs(t){var e=ri.ot(t);return Rr(yu(e)),e}function Qs(t,e){return Ys(t.t,e.path)}function Ks(t,e){var n=Hs(e);if(n.get(1)!==t.t.projectId)throw new Yr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Yr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new si(Zs(n))}function Xs(t,e){return Ys(t.t,e)}function Ws(t){var e=Hs(t);return 4===e.length?ri.ct():Zs(e)}function Js(t){return new ri(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Zs(t){return Rr(t.length>4&&"documents"===t.get(4)),t.Y(5)}function $s(t,e,n){return{name:Qs(t,e),fields:n.proto.mapValue.fields}}function tu(t,e,n){var r=Ks(t,e.name),i=Bs(e.updateTime),o=new Ci({mapValue:{fields:e.fields}});return new Ui(r,i,o,{hasCommittedMutations:!!n})}function eu(t,e){var n;if(e instanceof Jo)n={update:$s(t,e.key,e.value)};else if(e instanceof os)n={delete:Qs(t,e.key)};else if(e instanceof Zo)n={update:$s(t,e.key,e.data),updateMask:vu(e.Gt)};else{if(!(e instanceof ss))return Lr();n={verify:Qs(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Po)return{fieldPath:e.field.rt(),setToServerValue:"REQUEST_TIME"};if(n instanceof Co)return{fieldPath:e.field.rt(),appendMissingElements:{values:n.elements}};if(n instanceof Ro)return{fieldPath:e.field.rt(),removeAllFromArray:{values:n.elements}};if(n instanceof Uo)return{fieldPath:e.field.rt(),increment:n.Ut};throw Lr()}(0,t)})),e.jt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Gs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Lr()}(t,e.jt)),n}function nu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Go.updateTime(Bs(t.updateTime)):void 0!==t.exists?Go.exists(t.exists):Go.Kt()}(e.currentDocument):Go.Kt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Rr("REQUEST_TIME"===e.setToServerValue),n=new Po):"appendMissingElements"in e?n=new Co(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ro(e.removeAllFromArray.values||[]):"increment"in e?n=new Uo(t,e.increment):Lr();var r=oi.lt(e.fieldPath);return new Fo(r,n)}(t,e)}):[];if(e.update){var i=Ks(t,e.update.name),o=new Ci({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new hi((t.fieldPaths||[]).map(function(t){return oi.lt(t)}))}(e.updateMask);return new Zo(i,o,s,n,r)}return new Jo(i,o,n,r)}if(e.delete){var u=Ks(t,e.delete);return new os(u,n)}if(e.verify){var a=Ks(t,e.verify);return new ss(a,n)}return Lr()}function ru(t,e){return{documents:[Xs(t,e.path)]}}function iu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xs(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(ki(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NAN"}};if(Di(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ki(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NOT_NAN"}};if(Di(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fu(t.field),op:hu(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:fu(t.field),direction:cu(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Bt||bi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=uu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=uu(e.endAt)),n}function ou(t){var e=Ws(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Rr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=su(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new ro(lu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return bi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=au(n.startAt));var h=null;return n.endAt&&(h=au(n.endAt)),ao(e,i,u,s,a,"F",c,h)}function su(t){return t?void 0!==t.unaryFilter?[du(t)]:void 0!==t.fieldFilter?[pu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return su(t)}).reduce(function(t,e){return t.concat(e)}):Lr():[]}function uu(t){return{before:t.before,values:t.position}}function au(t){return new eo(t.values||[],!!t.before)}function cu(t){return Us[t]}function hu(t){return Ms[t]}function fu(t){return{fieldPath:t.rt()}}function lu(t){return oi.lt(t.fieldPath)}function pu(t){return Hi.create(lu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(t.fieldFilter.op),t.fieldFilter.value)}function du(t){switch(t.unaryFilter.op){case"IS_NAN":var e=lu(t.unaryFilter.field);return Hi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=lu(t.unaryFilter.field);return Hi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=lu(t.unaryFilter.field);return Hi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=lu(t.unaryFilter.field);return Hi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}function vu(t){var e=[];return t.fields.forEach(function(t){return e.push(t.rt())}),{fieldPaths:e}}function yu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var gu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},bu=function(){function t(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)},function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Nn&&Lr(),this.Nn=!0,this.xn?this.error?this.Fn(n,this.error):this.On(e,this.result):new t(function(t,i){r.Dn=function(n){r.On(e,n).next(t,i)},r.Cn=function(e){r.Fn(n,e).next(t,i)}})},t.prototype.kn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Mn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.On=function(e,n){return e?this.Mn(function(){return e(n)}):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Mn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.Ln=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.$n=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.Ln(r)},t}(),mu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new gu,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new Iu(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){var r=Nu(e.target.error);n.Bn.reject(new Iu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Iu(n,e)}},Object.defineProperty(t.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ou(e)},t}(),wu=function(){function t(e,n,r){this.name=e,this.version=n,this.Un=r,12.2===t.Qn(Object(E.g)())&&kr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Dr("SimpleDb","Removing database:",t),Tu(window.indexedDB.deleteDatabase(t)).kn()},t.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=Object(E.g)(),n=t.Qn(e),r=0<n&&n<10,i=t.jn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},t.zn=function(t,e){return t.store(e)},t.Qn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.jn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Hn=function(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n=this;return Object(jr.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Iu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Yr(Br.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Iu(t,n))},i.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Un.Jn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Dr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}})})},t.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(jr.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(jr.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(jr.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Hn(t)];case 2:return u.db=f.sent(),e=mu.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),bu.reject(t)}).kn(),a={},s.catch(function(){}),[4,e.qn];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return Dr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),_u=function(){function t(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(t.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ts=!0},t.prototype.ss=function(t){this.es=t},t.prototype.delete=function(){return Tu(this.Zn.delete())},t}(),Iu=function(t){function e(e,n){var r=this;return(r=t.call(this,Br.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(jr.c)(e,t),e}(Yr);function Eu(t){return"IndexedDbTransactionError"===t.name}var Ou=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Tu(n)},t.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Tu(this.store.add(t))},t.prototype.get=function(t){var e=this;return Tu(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Dr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Tu(this.store.delete(t))},t.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Tu(this.store.count())},t.prototype.rs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.os(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.cs=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.us=!1;var r=this.cursor(n);return this.os(r,function(t,e,n){return n.delete()})},t.prototype.hs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.os(r,e)},t.prototype.ls=function(t){var e=this.cursor({});return new bu(function(n,r){e.onerror=function(t){var e=Nu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.os=function(t,e){var n=[];return new bu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new _u(i),s=e(i.primaryKey,i.value,o);if(s instanceof bu){var u=s.catch(function(t){return o.done(),bu.reject(t)});n.push(u)}o.xn?r():null===o.ns?i.continue():i.continue(o.ns)}else r()}}).next(function(){return bu.Ln(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Tu(t){return new bu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Nu(t.target.error);n(e)}})}var ju=!1;function Nu(t){var e=wu.Qn(Object(E.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ju||(ju=!0,setTimeout(function(){throw r},0)),r}}return t}var Au=function(){function t(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new gu,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}return t.Ts=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Is=setTimeout(function(){return e.As()},t)},t.prototype.Rs=function(){return this.As()},t.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Yr(Br.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.As=function(){var t=this;this._s.Ps(function(){return null!==t.Is?(t.clearTimeout(),t.op().then(function(e){return t.Es.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},t}();function Su(t,e){if(kr("AsyncQueue",e+": "+t),Eu(t))return new Yr(Br.UNAVAILABLE,e+": "+t);throw t}var xu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Du=function(){function t(){this.ys=[]}return t.prototype.gs=function(t){this.ys.push(t)},t.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},t}();function ku(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Cu(e)),e=Pu(t.get(n),e);return Cu(e)}function Pu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Cu(t){return t+"\x01\x01"}function Lu(t){var e=t.length;if(Rr(e>=2),2===e)return Rr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ri.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Lr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new ri(r)}var Ru=function(t,e){this.seconds=t,this.nanoseconds=e},Vu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Vu.store="owner",Vu.key="owner";var Uu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Uu.store="mutationQueues",Uu.keyPath="userId";var Mu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Mu.store="mutations",Mu.keyPath="batchId",Mu.userMutationsIndex="userMutationsIndex",Mu.userMutationsKeyPath=["userId","batchId"];var qu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ku(e)]},t.key=function(t,e,n){return[t,ku(e),n]},t}();qu.store="documentMutations",qu.PLACEHOLDER=new qu;var Fu=function(t,e){this.path=t,this.readTime=e},zu=function(t,e){this.path=t,this.version=e},Gu=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Gu.store="remoteDocuments",Gu.readTimeIndex="readTimeIndex",Gu.readTimeIndexPath="readTime",Gu.collectionReadTimeIndex="collectionReadTimeIndex",Gu.collectionReadTimeIndexPath=["parentPath","readTime"];var Bu=function(t){this.byteSize=t};Bu.store="remoteDocumentGlobal",Bu.key="remoteDocumentGlobalKey";var Yu=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Yu.store="targets",Yu.keyPath="targetId",Yu.queryTargetsIndexName="queryTargetsIndex",Yu.queryTargetsKeyPath=["canonicalId","targetId"];var Hu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Hu.store="targetDocuments",Hu.keyPath=["targetId","path"],Hu.documentTargetsIndex="documentTargetsIndex",Hu.documentTargetsKeyPath=["path","targetId"];var Qu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Qu.key="targetGlobalKey",Qu.store="targetGlobal";var Ku=function(t,e){this.collectionId=t,this.parent=e};Ku.store="collectionParents",Ku.keyPath=["collectionId","parent"];var Xu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Xu.store="clientMetadata",Xu.keyPath="clientId";var Wu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Wu.store="bundles",Wu.keyPath="bundleId";var Ju=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ju.store="namedQueries",Ju.keyPath="name";var Zu=Object(jr.g)(Object(jr.g)(Object(jr.g)(Object(jr.g)([Uu.store,Mu.store,qu.store,Gu.store,Yu.store,Vu.store,Qu.store,Hu.store],[Xu.store]),[Bu.store]),[Ku.store]),[Wu.store,Ju.store]),$u=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ps=e,r.bs=n,r}return Object(jr.c)(e,t),e}(Du);function ta(t,e){var n=Vr(t);return wu.zn(n.ps,e)}var ea=function(){function t(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ss=function(t,e,n){for(var r=n.Ds,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ho(o,e,r[i]))}return e},t.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Qo(s,e,this.vs));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Qo(s,e,this.vs))}return e},t.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Es())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Fr(this.mutations,t.mutations,function(t,e){return Xo(t,e)})&&Fr(this.baseMutations,t.baseMutations,function(t,e){return Xo(t,e)})},t}(),na=function(){function t(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.Fs=r}return t.from=function(e,n,r){Rr(e.mutations.length===r.length);for(var i=_s(),o=e.mutations,s=0;s<o.length;s++)i=i.zt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ra=function(t){this.Os=t};function ia(t,e){if(e.document)return tu(t.Os,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=si.Et(e.noDocument.path),r=ca(e.noDocument.readTime);return new Mi(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=si.Et(e.unknownDocument.path);return r=ca(e.unknownDocument.version),new qi(i,r)}return Lr()}function oa(t,e,n){var r=sa(n),i=e.key.path.X().it();if(e instanceof Ui){var o=function(t,e){return{name:Qs(t,e.key),fields:e.bt().mapValue.fields,updateTime:Fs(t,e.version.j())}}(t.Os,e),s=e.hasCommittedMutations;return new Gu(null,null,o,s,r,i)}if(e instanceof Mi){var u=e.key.path.it(),a=aa(e.version);return s=e.hasCommittedMutations,new Gu(null,new Fu(u,a),null,s,r,i)}if(e instanceof qi){var c=e.key.path.it(),h=aa(e.version);return new Gu(new zu(c,h),null,null,!0,r,i)}return Lr()}function sa(t){var e=t.j();return[e.seconds,e.nanoseconds]}function ua(t){var e=new ti(t[0],t[1]);return ei.K(e)}function aa(t){var e=t.j();return new Ru(e.seconds,e.nanoseconds)}function ca(t){var e=new ti(t.seconds,t.nanoseconds);return ei.K(e)}function ha(t,e){for(var n=(e.baseMutations||[]).map(function(e){return nu(t.Os,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return nu(t.Os,e)}),o=ti.fromMillis(e.localWriteTimeMs);return new ea(e.batchId,o,n,i)}function fa(t){var e,n,r=ca(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ca(t.lastLimboFreeSnapshotVersion):ei.min();return void 0!==t.query.documents?(Rr(1===(n=t.query).documents.length),e=go(co(Ws(n.documents[0])))):e=function(t){return go(ou(t))}(t.query),new To(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Gr.fromBase64String(t.resumeToken))}function la(t,e){var n,r=aa(e.kt),i=aa(e.lastLimboFreeSnapshotVersion);n=Yi(e.target)?ru(t.Os,e.target):iu(t.Os,e.target);var o=e.resumeToken.toBase64();return new Yu(e.targetId,Gi(e.target),r,o,e.sequenceNumber,i,n)}function pa(t){var e=ou({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?bo(e,e.limit,"L"):e}var da=function(){function t(){}return t.prototype.ks=function(t,e){return va(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ca(e.createTime),version:e.version};var e})},t.prototype.Ms=function(t,e){return va(t).put({bundleId:(n=e).id,createTime:aa(Bs(n.createTime)),version:n.version});var n},t.prototype.Ls=function(t,e){return ya(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:pa(e.bundledQuery),readTime:ca(e.readTime)};var e})},t.prototype.$s=function(t,e){return ya(t).put(function(t){return{name:t.name,readTime:aa(Bs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function va(t){return ta(t,Wu.store)}function ya(t){return ta(t,Ju.store)}var ga=function(){function t(){this.Bs=new ba}return t.prototype.qs=function(t,e){return this.Bs.add(e),bu.resolve()},t.prototype.Us=function(t,e){return bu.resolve(this.Bs.getEntries(e))},t}(),ba=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new ps(ri.H),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.tt(),n=t.X(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ps(ri.H)).it()},t}(),ma=function(){function t(){this.Qs=new ba}return t.prototype.qs=function(t,e){var n=this;if(!this.Qs.has(e)){var r=e.tt(),i=e.X();t.gs(function(){n.Qs.add(e)});var o={collectionId:r,parent:ku(i)};return wa(t).put(o)}return bu.resolve()},t.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[zr(e),""],!1,!0);return wa(t).rs(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Lu(o.parent))}return n})},t}();function wa(t){return ta(t,Ku.store)}var _a={Ks:!1,Ws:0,js:0,Gs:0},Ia=function(){function t(t,e,n){this.zs=t,this.Hs=e,this.Js=n}return t.Ys=function(e){return new t(e,t.Xs,t.Zs)},t}();function Ea(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){if(t.code!==Br.FAILED_PRECONDITION||t.message!==xu)throw t;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}Ia.Xs=10,Ia.Zs=1e3,Ia.ti=new Ia(41943040,Ia.Xs,Ia.Zs),Ia.ei=new Ia(-1,0,0);var Oa=function(){function t(t,e){this.ni=t,this.si=e,this.ii={}}return t.prototype.get=function(t){var e=this.ni(t),n=this.ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.si(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ai(this.ii,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.et=function(){return ci(this.ii)},t}(),Ta=function(){function t(){this.ri=new Oa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.oi=!1}return t.prototype.ci=function(t){var e=this.ri.get(t);return e?e.readTime:ei.min()},t.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},t.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},t.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?bu.resolve(n.hi):this.fi(t,e)},t.prototype.getEntries=function(t,e){return this.di(t,e)},t.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},t.prototype.ui=function(){},t}();function ja(t,e,n){var r=t.store(Mu.store),i=t.store(qu.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.hs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Rr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=qu.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return bu.Ln(o).next(function(){return c})}function Na(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}var Aa=function(){function t(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}return t.mi=function(e,n,r,i){return Rr(""!==e.uid),new t(e.m()?e.uid:"",n,r,i)},t.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xa(t).hs({index:Mu.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Ri=function(t,e,n,r){var i=this,o=Da(t),s=xa(t);return s.add({}).next(function(u){Rr("number"==typeof u);for(var a=new ea(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return eu(t.Os,e)}),i=n.mutations.map(function(e){return eu(t.Os,e)});return new Mu(e,n.batchId,n.vs.toMillis(),r,i)}(i.Qt,i.userId,a),h=[],f=new ps(function(t,e){return qr(t.rt(),e.rt())}),l=0,p=r;l<p.length;l++){var d=p[l],v=qu.key(i.userId,d.key.path,u);f=f.add(d.key.path.X()),h.push(s.put(c)),h.push(o.put(v,qu.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ei.qs(t,e))}),t.gs(function(){i.Ii[u]=a.keys()}),bu.Ln(h).next(function(){return a})})},t.prototype.Pi=function(t,e){var n=this;return xa(t).get(e).next(function(t){return t?(Rr(t.userId===n.userId),ha(n.Qt,t)):null})},t.prototype.yi=function(t,e){var n=this;return this.Ii[e]?bu.resolve(this.Ii[e]):this.Pi(t,e).next(function(t){if(t){var r=t.keys();return n.Ii[e]=r,r}return null})},t.prototype.gi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return xa(t).hs({index:Mu.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Rr(e.batchId>=r),o=ha(n.Qt,e)),i.done()}).next(function(){return o})},t.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return xa(t).hs({index:Mu.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xa(t).rs(Mu.userMutationsIndex,n).next(function(t){return t.map(function(t){return ha(e.Qt,t)})})},t.prototype.bi=function(t,e){var n=this,r=qu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Da(t).hs({range:i},function(r,i,s){var u=r[0],a=r[2],c=Lu(r[1]);if(u===n.userId&&e.path.isEqual(c))return xa(t).get(a).next(function(t){if(!t)throw Lr();Rr(t.userId===n.userId),o.push(ha(n.Qt,t))});s.done()}).next(function(){return o})},t.prototype.vi=function(t,e){var n=this,r=new ps(qr),i=[];return e.forEach(function(e){var o=qu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Da(t).hs({range:s},function(t,i,o){var s=t[0],u=t[2],a=Lu(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),bu.Ln(i).next(function(){return n.Si(t,r)})},t.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=qu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new ps(qr);return Da(t).hs({range:s},function(t,e,o){var s=t[0],a=t[2],c=Lu(t[1]);s===n.userId&&r.nt(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Si(t,u)})},t.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(xa(t).get(e).next(function(t){if(null===t)throw Lr();Rr(t.userId===n.userId),r.push(ha(n.Qt,t))}))}),bu.Ln(i).next(function(){return r})},t.prototype.Ci=function(t,e){var n=this;return ja(t.ps,this.userId,e).next(function(r){return t.gs(function(){n.xi(e.batchId)}),bu.forEach(r,function(e){return n.Ti.Ni(t,e)})})},t.prototype.xi=function(t){delete this.Ii[t]},t.prototype.Fi=function(t){var e=this;return this.Ai(t).next(function(n){if(!n)return bu.resolve();var r=IDBKeyRange.lowerBound(qu.prefixForUser(e.userId)),i=[];return Da(t).hs({range:r},function(t,n,r){if(t[0]===e.userId){var o=Lu(t[1]);i.push(o)}else r.done()}).next(function(){Rr(0===i.length)})})},t.prototype.Oi=function(t,e){return Sa(t,this.userId,e)},t.prototype.ki=function(t){var e=this;return ka(t).get(this.userId).next(function(t){return t||new Uu(e.userId,-1,"")})},t}();function Sa(t,e,n){var r=qu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Da(t).hs({range:o,us:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function xa(t){return ta(t,Mu.store)}function Da(t){return ta(t,qu.store)}function ka(t){return ta(t,Uu.store)}var Pa=function(){function t(t){this.Mi=t}return t.prototype.next=function(){return this.Mi+=2,this.Mi},t.Li=function(){return new t(0)},t.$i=function(){return new t(-1)},t}(),Ca=function(){function t(t,e){this.Ti=t,this.Qt=e}return t.prototype.Bi=function(t){var e=this;return this.qi(t).next(function(n){var r=new Pa(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next(function(){return n.highestTargetId})})},t.prototype.Qi=function(t){return this.qi(t).next(function(t){return ei.K(new ti(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Ki=function(t){return this.qi(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)})},t.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next(function(){return n.qi(t).next(function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)})})},t.prototype.Hi=function(t,e){return this.Gi(t,e)},t.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next(function(){return La(t).delete(e.targetId)}).next(function(){return n.qi(t)}).next(function(e){return Rr(e.targetCount>0),e.targetCount-=1,n.Ui(t,e)})},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return La(t).hs(function(s,u){var a=fa(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Ji(t,a)))}).next(function(){return bu.Ln(o)}).next(function(){return i})},t.prototype.In=function(t,e){return La(t).hs(function(t,n){var r=fa(n);e(r)})},t.prototype.qi=function(t){return Ra(t).get(Qu.key).next(function(t){return Rr(null!==t),t})},t.prototype.Ui=function(t,e){return Ra(t).put(Qu.key,e)},t.prototype.Gi=function(t,e){return La(t).put(la(this.Qt,e))},t.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Zi=function(t){return this.qi(t).next(function(t){return t.targetCount})},t.prototype.tr=function(t,e){var n=Gi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return La(t).hs({range:r,index:Yu.queryTargetsIndexName},function(t,n,r){var o=fa(n);Bi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.er=function(t,e,n){var r=this,i=[],o=Va(t);return e.forEach(function(e){var s=ku(e.path);i.push(o.put(new Hu(n,s))),i.push(r.Ti.nr(t,n,e))}),bu.Ln(i)},t.prototype.sr=function(t,e,n){var r=this,i=Va(t);return bu.forEach(e,function(e){var o=ku(e.path);return bu.Ln([i.delete([n,o]),r.Ti.ir(t,n,e)])})},t.prototype.Yi=function(t,e){var n=Va(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.rr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Va(t),i=Es();return r.hs({range:n,us:!0},function(t,e,n){var r=Lu(t[1]),o=new si(r);i=i.add(o)}).next(function(){return i})},t.prototype.Oi=function(t,e){var n=ku(e.path),r=IDBKeyRange.bound([n],[zr(n)],!1,!0),i=0;return Va(t).hs({index:Hu.documentTargetsIndex,us:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Sn=function(t,e){return La(t).get(e).next(function(t){return t?fa(t):null})},t}();function La(t){return ta(t,Yu.store)}function Ra(t){return ta(t,Qu.store)}function Va(t){return ta(t,Hu.store)}function Ua(t,e){var n=t[1],r=e[1],i=qr(t[0],e[0]);return 0===i?qr(n,r):i}var Ma=function(){function t(t){this.cr=t,this.buffer=new ps(Ua),this.ar=0}return t.prototype.ur=function(){return++this.ar},t.prototype.hr=function(t){var e=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ua(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),qa=function(){function t(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}return t.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},t.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(t.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),t.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,function(){return Object(jr.b)(e,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return Eu(e=n.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ea(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}})})})},t}(),Fa=function(){function t(t,e){this.mr=t,this.params=e}return t.prototype.Ar=function(t,e){return this.mr.Rr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Pr=function(t,e){var n=this;if(0===e)return bu.resolve($r.q);var r=new Ma(e);return this.mr.In(t,function(t){return r.hr(t.sequenceNumber)}).next(function(){return n.mr.yr(t,function(t){return r.hr(t)})}).next(function(){return r.maxValue})},t.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},t.prototype.gr=function(t,e){return this.mr.gr(t,e)},t.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),bu.resolve(_a)):this.pr(t).next(function(r){return r<n.params.zs?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),_a):n.br(t,e)})},t.prototype.pr=function(t){return this.mr.pr(t)},t.prototype.br=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Ar(t,this.params.Hs).next(function(e){return e>c.params.Js?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Js+" from "+e),r=c.params.Js):r=e,o=Date.now(),c.Pr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Xi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.gr(t,n)}).next(function(t){return a=Date.now(),xr()<=I.a.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),bu.resolve({Ks:!0,Ws:r,js:i,Gs:t})})},t}(),za=function(){function t(t,e){this.db=t,this.lr=function(t,e){return new Fa(t,e)}(this,e)}return t.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.vr=function(t){var e=0;return this.yr(t,function(t){e++}).next(function(){return e})},t.prototype.In=function(t,e){return this.db.Sr().In(t,e)},t.prototype.yr=function(t,e){return this.Dr(t,function(t,n){return e(n)})},t.prototype.nr=function(t,e,n){return Ga(t,n)},t.prototype.ir=function(t,e,n){return Ga(t,n)},t.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},t.prototype.Ni=function(t,e){return Ga(t,e)},t.prototype.Cr=function(t,e){return function(t,e){var n=!1;return ka(t).ls(function(r){return Sa(t,r,e).next(function(t){return t&&(n=!0),bu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.gr=function(t,e){var n=this,r=this.db.Fr().Nr(),i=[],o=0;return this.Dr(t,function(s,u){if(u<=e){var a=n.Cr(t,s).next(function(e){if(!e)return o++,r._i(t,s).next(function(){return r.li(s),Va(t).delete([0,ku(s.path)])})});i.push(a)}}).next(function(){return bu.Ln(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Mt(t.bs);return this.db.Sr().Hi(t,n)},t.prototype.Or=function(t,e){return Ga(t,e)},t.prototype.Dr=function(t,e){var n,r=Va(t),i=$r.q;return r.hs({index:Hu.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==$r.q&&e(new si(Lu(n)),i),i=s,n=o):i=$r.q}).next(function(){i!==$r.q&&e(new si(Lu(n)),i)})},t.prototype.pr=function(t){return this.db.Fr().kr(t)},t}();function Ga(t,e){return Va(t).put(function(t,e){return new Hu(0,ku(t.path),e)}(e,t.bs))}var Ba=function(){function t(t,e){this.Qt=t,this.Ei=e}return t.prototype.ai=function(t,e,n){return Qa(t).put(Ka(e),n)},t.prototype.li=function(t,e){var n=Qa(t),r=Ka(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Mr(t,r)})},t.prototype._i=function(t,e){var n=this;return Qa(t).get(Ka(e)).next(function(t){return n.Lr(t)})},t.prototype.$r=function(t,e){var n=this;return Qa(t).get(Ka(e)).next(function(t){var e=n.Lr(t);return e?{hi:e,size:Na(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=gs();return this.Br(t,e,function(t,e){var i=n.Lr(e);r=r.zt(t,i)}).next(function(){return r})},t.prototype.qr=function(t,e){var n=this,r=gs(),i=new hs(si.H);return this.Br(t,e,function(t,e){var o=n.Lr(e);o?(r=r.zt(t,o),i=i.zt(t,Na(e))):(r=r.zt(t,null),i=i.zt(t,0))}).next(function(){return{Ur:r,Qr:i}})},t.prototype.Br=function(t,e,n){if(e.et())return bu.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return Qa(t).hs({range:r},function(t,e,r){for(var s=si.Et(t);o&&si.H(o,s)<0;)n(o,null),o=i.oe();o&&o.isEqual(s)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ce()?i.oe():null})},t.prototype.Kr=function(t,e,n){var r=this,i=ms(),o=e.path.length+1,s={};if(n.isEqual(ei.min())){var u=e.path.it();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.it(),c=sa(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Gu.collectionReadTimeIndex}return Qa(t).hs(s,function(t,n,s){if(t.length===o){var u=ia(r.Qt,n);e.path.nt(u.key.path)?u instanceof Ui&&Io(e,u)&&(i=i.zt(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Nr=function(t){return new Ya(this,!!t&&t.Wr)},t.prototype.kr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ha(t).get(Bu.key).next(function(t){return Rr(!!t),t})},t.prototype.Mr=function(t,e){return Ha(t).put(Bu.key,e)},t.prototype.Lr=function(t){if(t){var e=ia(this.Qt,t);return e instanceof Mi&&e.version.isEqual(ei.min())?null:e}return null},t}(),Ya=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jr=e,r.Wr=n,r.Gr=new Oa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(jr.c)(e,t),e.prototype.wi=function(t){var e=this,n=[],r=0,i=new ps(function(t,e){return qr(t.rt(),e.rt())});return this.ri.forEach(function(o,s){var u=e.Gr.get(o);if(s.hi){var a=oa(e.jr.Qt,s.hi,e.ci(o));i=i.add(o.path.X());var c=Na(a);r+=c-u,n.push(e.jr.ai(t,o,a))}else if(r-=u,e.Wr){var h=oa(e.jr.Qt,new Mi(o,ei.min()),e.ci(o));n.push(e.jr.ai(t,o,h))}else n.push(e.jr.li(t,o))}),i.forEach(function(r){n.push(e.jr.Ei.qs(t,r))}),n.push(this.jr.updateMetadata(t,r)),bu.Ln(n)},e.prototype.fi=function(t,e){var n=this;return this.jr.$r(t,e).next(function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)})},e.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next(function(t){var e=t.Ur;return t.Qr.forEach(function(t,e){n.Gr.set(t,e)}),e})},e}(Ta);function Ha(t){return ta(t,Bu.store)}function Qa(t){return ta(t,Gu.store)}function Ka(t){return t.path.it()}var Xa=function(){function t(t){this.Qt=t}return t.prototype.Jn=function(t,e,n,r){var i=this;Rr(n<r&&n>=0&&r<=11);var o=new mu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Vu.store)}(t),function(t){t.createObjectStore(Uu.store,{keyPath:Uu.keyPath}),t.createObjectStore(Mu.store,{keyPath:Mu.keyPath,autoIncrement:!0}).createIndex(Mu.userMutationsIndex,Mu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(qu.store)}(t),Wa(t),function(t){t.createObjectStore(Gu.store)}(t));var s=bu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Hu.store),t.deleteObjectStore(Yu.store),t.deleteObjectStore(Qu.store)}(t),Wa(t)),s=s.next(function(){return function(t){var e=t.store(Qu.store),n=new Qu(0,0,ei.min().j(),0);return e.put(Qu.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Mu.store).rs().next(function(n){t.deleteObjectStore(Mu.store),t.createObjectStore(Mu.store,{keyPath:Mu.keyPath,autoIncrement:!0}).createIndex(Mu.userMutationsIndex,Mu.userMutationsKeyPath,{unique:!0});var r=e.store(Mu.store),i=n.map(function(t){return r.put(t)});return bu.Ln(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Xu.store,{keyPath:Xu.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.zr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Bu.store)}(t),i.Hr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Jr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Yr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Gu.store);e.createIndex(Gu.readTimeIndex,Gu.readTimeIndexPath,{unique:!1}),e.createIndex(Gu.collectionReadTimeIndex,Gu.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Xr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Wu.store,{keyPath:Wu.keyPath})}(t),function(t){t.createObjectStore(Ju.store,{keyPath:Ju.keyPath})}(t)})),s},t.prototype.Hr=function(t){var e=0;return t.store(Gu.store).hs(function(t,n){e+=Na(n)}).next(function(){var n=new Bu(e);return t.store(Bu.store).put(Bu.key,n)})},t.prototype.zr=function(t){var e=this,n=t.store(Uu.store),r=t.store(Mu.store);return n.rs().next(function(n){return bu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(Mu.userMutationsIndex,i).next(function(r){return bu.forEach(r,function(r){Rr(r.userId===n.userId);var i=ha(e.Qt,r);return ja(t,n.userId,i).next(function(){})})})})})},t.prototype.Jr=function(t){var e=t.store(Hu.store),n=t.store(Gu.store);return t.store(Qu.store).get(Qu.key).next(function(t){var r=[];return n.hs(function(n,i){var o=new ri(n),s=function(t){return[0,ku(t)]}(o);r.push(e.get(s).next(function(n){return n?bu.resolve():function(n){return e.put(new Hu(0,ku(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return bu.Ln(r)})})},t.prototype.Yr=function(t,e){t.createObjectStore(Ku.store,{keyPath:Ku.keyPath});var n=e.store(Ku.store),r=new ba,i=function(t){if(r.add(t)){var e=t.tt(),i=t.X();return n.put({collectionId:e,parent:ku(i)})}};return e.store(Gu.store).hs({us:!0},function(t,e){var n=new ri(t);return i(n.X())}).next(function(){return e.store(qu.store).hs({us:!0},function(t,e){var n=Lu(t[1]);return i(n.X())})})},t.prototype.Xr=function(t){var e=this,n=t.store(Yu.store);return n.hs(function(t,r){var i=fa(r),o=la(e.Qt,i);return n.put(o)})},t}();function Wa(t){t.createObjectStore(Hu.store,{keyPath:Hu.keyPath}).createIndex(Hu.documentTargetsIndex,Hu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Yu.store,{keyPath:Yu.keyPath}).createIndex(Yu.queryTargetsIndexName,Yu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Qu.store)}var Ja="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Za=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=s,this.document=u,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!t.Kn())throw new Yr(Br.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new za(this,i),this.ho=n+"main",this.Qt=new ra(a),this.lo=new wu(this.ho,11,new Xa(this.Qt)),this._o=new Ca(this.Ti,this.Qt),this.Ei=new ma,this.fo=function(t,e){return new Ba(t,e)}(this.Qt,this.Ei),this.wo=new da,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===h&&kr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.To().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Yr(Br.FAILED_PRECONDITION,Ja);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t._o.Ki(e)})}).then(function(e){t.so=new $r(e,t.eo)}).then(function(){t.io=!0}).catch(function(e){return t.lo&&t.lo.close(),Promise.reject(e)})},t.prototype.Ro=function(t){var e=this;return this.uo=function(n){return Object(jr.b)(e,void 0,void 0,function(){return Object(jr.d)(this,function(e){return this.Er?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.Po=function(t){var e=this;this.lo.Xn(function(n){return Object(jr.b)(e,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps(function(){return Object(jr.b)(e,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return tc(e).put(new Xu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Vo(e).next(function(e){e||(t.isPrimary=!1,t.Zr.po(function(){return t.uo(!1)}))})}).next(function(){return t.bo(e)}).next(function(n){return t.isPrimary&&!n?t.vo(e).next(function(){return!1}):!!n&&t.So(e).next(function(){return!0})})}).catch(function(e){if(Eu(e))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Zr.po(function(){return t.uo(e)}),t.isPrimary=e})},t.prototype.Vo=function(t){var e=this;return $a(t).get(Vu.key).next(function(t){return bu.resolve(e.Do(t))})},t.prototype.Co=function(t){return tc(t).delete(this.clientId)},t.prototype.xo=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(jr.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=ta(t,Xu.store);return e.rs().next(function(t){var n=r.Fo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return bu.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)this.Eo.removeItem(this.Oo(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,function(){return t.To().then(function(){return t.xo()}).then(function(){return t.Ao()})})},t.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bo=function(t){var e=this;return this.no?bu.resolve(!0):$a(t).get(Vu.key).next(function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.ko(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new Yr(Br.FAILED_PRECONDITION,Ja);return!1}}return!(!e.networkEnabled||!e.inForeground)||tc(t).rs().next(function(t){return void 0===e.Fo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Mo=function(){return Object(jr.b)(this,void 0,void 0,function(){var t=this;return Object(jr.d)(this,function(e){switch(e.label){case 0:return this.io=!1,this.Lo(),this.co&&(this.co.cancel(),this.co=null),this.$o(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Vu.store,Xu.store],function(e){var n=new $u(e,$r.q);return t.vo(n).next(function(){return t.Co(n)})})];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}})})},t.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.No(t.updateTimeMs,e)&&!n.ko(t.clientId)})},t.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return tc(e).rs().next(function(e){return t.Fo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t){return Aa.mi(t,this.Qt,this.Ei,this.Ti)},t.prototype.Sr=function(){return this._o},t.prototype.Fr=function(){return this.fo},t.prototype.Ko=function(){return this.Ei},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Dr("IndexedDbPersistence","Starting transaction:",t),this.lo.runTransaction(t,"readonly"===e?"readonly":"readwrite",Zu,function(o){return r=new $u(o,i.so?i.so.next():$r.q),"readwrite-primary"===e?i.Vo(r).next(function(t){return!!t||i.bo(r)}).next(function(e){if(!e)throw kr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Zr.po(function(){return i.uo(!1)}),new Yr(Br.FAILED_PRECONDITION,xu);return n(r)}).next(function(t){return i.So(r).next(function(){return t})}):i.jo(r).next(function(){return n(r)})}).then(function(t){return r.Vs(),t})},t.prototype.jo=function(t){var e=this;return $a(t).get(Vu.key).next(function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.ko(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Br.FAILED_PRECONDITION,Ja)})},t.prototype.So=function(t){var e=new Vu(this.clientId,this.allowTabSynchronization,Date.now());return $a(t).put(Vu.key,e)},t.Kn=function(){return wu.Kn()},t.prototype.vo=function(t){var e=this,n=$a(t);return n.get(Vu.key).next(function(t){return e.Do(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(Vu.key)):bu.resolve()})},t.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(kr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps(function(){return t.inForeground="visible"===t.document.visibilityState,t.To()})},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.$o=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},t.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Lo(),e.Zr.Ps(function(){return e.Mo()})},this.window.addEventListener("unload",this.ro))},t.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},t.prototype.ko=function(t){var e;try{var n=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Oo(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return kr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Lo=function(){if(this.Eo)try{this.Eo.setItem(this.Oo(this.clientId),String(Date.now()))}catch(t){kr("Failed to set zombie client id.",t)}},t.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Oo(this.clientId))}catch(t){}},t.prototype.Oo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function $a(t){return ta(t,Vu.store)}function tc(t){return ta(t,Xu.store)}function ec(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var nc=function(t,e){this.progress=t,this.Go=e},rc=function(){function t(t,e,n){this.fo=t,this.zo=e,this.Ei=n}return t.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next(function(r){return n.Jo(t,e,r)})},t.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t})},t.prototype.Yo=function(t,e,n){var r=gs();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)}),r},t.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next(function(e){return n.Zo(t,e)})},t.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next(function(r){var i=n.Yo(t,e,r),o=ys();return i.forEach(function(t,e){e||(e=new Mi(t,ei.min())),o=o.zt(t,e)}),o})},t.prototype.Kr=function(t,e,n){return function(t){return si.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.tc(t,e.path):vo(e)?this.ec(t,e,n):this.nc(t,e,n)},t.prototype.tc=function(t,e){return this.Ho(t,new si(e)).next(function(t){var e=ms();return t instanceof Ui&&(e=e.zt(t.key,t)),e})},t.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=ms();return this.Ei.Us(t,i).next(function(s){return bu.forEach(s,function(s){var u=function(t,e){return new uo(e,null,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.nc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.zt(t,e)})})}).next(function(){return o})})},t.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next(function(n){return r=n,o.zo.Di(t,e)}).next(function(e){return o.sc(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Qo(a,r.get(c),o.vs);r=h instanceof Ui?r.zt(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Io(e,n)||(r=r.remove(t))}),r})},t.prototype.sc=function(t,e,n){for(var r=Es(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Zo&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ui&&(c=c.zt(t,e))}),c})},t}(),ic=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}return t.oc=function(e,n){for(var r=Es(),i=Es(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),oc=function(){function t(){}return t.prototype.cc=function(t){this.ac=t},t.prototype.Kr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.xt.length||1===t.xt.length&&t.xt[0].field.ut())}(e)||n.isEqual(ei.min())?this.uc(t,e):this.ac.Xo(t,r).next(function(o){var s=i.hc(e,o);return(ho(e)||fo(e))&&i.lc(e.limitType,s,r,n)?i.uc(t,e):(xr()<=I.a.DEBUG&&Dr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),_o(e)),i.ac.Kr(t,e,n).next(function(t){return s.forEach(function(e){t=t.zt(e.key,e)}),t}))})},t.prototype.hc=function(t,e){var n=new ps(Eo(t));return e.forEach(function(e,r){r instanceof Ui&&Io(t,r)&&(n=n.add(r))}),n},t.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version._(r)>0)},t.prototype.uc=function(t,e){return xr()<=I.a.DEBUG&&Dr("QueryEngine","Using full collection scan to execute query:",_o(e)),this.ac.Kr(t,e,ei.min())},t}(),sc=function(){function t(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new hs(qr),this.dc=new Oa(function(t){return Gi(t)},Bi),this.wc=ei.min(),this.zo=t.Qo(n),this.Ec=t.Fr(),this._o=t.Sr(),this.Tc=new rc(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return t.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Vr(n,e.fc)})},t}();function uc(t,e,n,r){return new sc(t,e,n,r)}function ac(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(jr.d)(this,function(s){switch(s.label){case 0:return n=Vr(t),r=n.zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.zo.pi(t).next(function(s){return o=s,r=n.persistence.Qo(e),i=new rc(n.Ec,r,n.persistence.Ko()),r.pi(t)}).next(function(e){for(var n=[],r=[],s=Es(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Xo(t,s).next(function(t){return{Ic:t,mc:n,Ac:r}})})})];case 1:return o=s.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),o)]}})})}function cc(t,e){var n=Vr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Ec.Nr({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=bu.resolve();return o.forEach(function(t){s=s.next(function(){return r._i(e,t)}).next(function(e){var o=e,s=n.Fs.get(t);Rr(null!==s),(!o||o.version._(s)<0)&&(o=i.Ss(t,o,n))&&r.ai(o,n.Ns)})}),s.next(function(){return t.zo.Ci(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.zo.Fi(t)}).next(function(){return n.Tc.Xo(t,r)})})}function hc(t){var e=Vr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e._o.Qi(t)})}function fc(t,e){var n=Vr(t),r=e.kt,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var s=[];e.Fe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n._o.sr(t,e.Qe,o).next(function(){return n._o.er(t,e.qe,o)}));var a=e.resumeToken;if(a.l()>0){var c=u.Lt(a,r).Mt(t.bs);i=i.zt(o,c),function(t,e,n){return Rr(e.resumeToken.l()>0),0===t.resumeToken.l()||e.kt.W()-t.kt.W()>=3e8||n.qe.size+n.Ue.size+n.Qe.size>0}(u,c,e)&&s.push(n._o.Hi(t,c))}}});var u=ys();if(e.ke.forEach(function(r,i){e.Me.has(r)&&s.push(n.persistence.Ti.Or(t,r))}),s.push(lc(t,o,e.ke,r,void 0).next(function(t){u=t})),!r.isEqual(ei.min())){var a=n._o.Qi(t).next(function(e){return n._o.Wi(t,t.bs,r)});s.push(a)}return bu.Ln(s).next(function(){return o.apply(t)}).next(function(){return n.Tc.Zo(t,u)})}).then(function(t){return n.fc=i,t})}function lc(t,e,n,r,i){var o=Es();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=ys();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Mi&&s.version.isEqual(ei.min())?(e.li(n,a),o=o.zt(n,s)):null==u||s.version._(u.version)>0||0===s.version._(u.version)&&u.hasPendingWrites?(e.ai(s,a),o=o.zt(n,s)):Dr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function pc(t,e){var n=Vr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.zo.gi(t,e)})}function dc(t,e){var n=Vr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n._o.tr(t,e).next(function(i){return i?bu.resolve(r=i):n._o.Bi(t).next(function(i){return r=new To(e,i,0,t.bs),n._o.ji(t,r).next(function(){return r})})})}).then(function(t){var r=n.fc.get(t.targetId);return(null===r||t.kt._(r.kt)>0)&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t})}function vc(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:r=Vr(t),i=r.fc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ti.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Eu(s=u.sent()))throw s;return Dr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(i.target),[2]}})})}function yc(t,e,n){var r=Vr(t),i=ei.min(),o=Es();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Vr(t),i=r.dc.get(n);return void 0!==i?bu.resolve(r.fc.get(i)):r._o.tr(e,n)}(r,t,go(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next(function(t){o=t})}).next(function(){return r._c.Kr(t,e,n?i:ei.min(),n?o:Es())}).next(function(t){return{documents:t,Rc:o}})})}function gc(t,e){var n=Vr(t),r=Vr(n._o),i=n.fc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Sn(t,e).next(function(t){return t?t.target:null})})}function bc(t){var e=Vr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Vr(t),i=ys(),o=sa(n),s=Qa(e),u=IDBKeyRange.lowerBound(o,!0);return s.hs({index:Gu.readTimeIndex,range:u},function(t,e){var n=ia(r.Qt,e);i=i.zt(n.key,n),o=e.readTime}).next(function(){return{Go:i,readTime:ua(o)}})}(e.Ec,t,e.wc)}).then(function(t){var n=t.Go;return e.wc=t.readTime,n})}function mc(t){return Object(jr.b)(this,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){return[2,(e=Vr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Qa(t),n=ei.min();return e.hs({index:Gu.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=ua(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.wc=t})]})})}function wc(t,e,n,r){return Object(jr.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(jr.d)(this,function(d){switch(d.label){case 0:for(i=Vr(t),o=Es(),s=ys(),u=_s(),a=0,c=n;a<c.length;a++)f=e.Pc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.zt(f,e.yc(h)),u=u.zt(f,e.gc(h.metadata.readTime));return l=i.Ec.Nr({Wr:!0}),[4,dc(i,function(t){return go(co(ri.ot("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return lc(t,l,s,ei.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i._o.Yi(t,p.targetId).next(function(){return i._o.er(t,o,p.targetId)}).next(function(){return i.Tc.Zo(t,e)})})})]}})})}function _c(t,e,n){return void 0===n&&(n=Es()),Object(jr.b)(this,void 0,void 0,function(){var r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return[4,dc(t,go(pa(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Vr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Bs(e.readTime);if(r.kt._(o)>=0)return i.wo.$s(t,e);var s=r.Lt(Gr.T,o);return i.fc=i.fc.zt(s.targetId,s),i._o.Hi(t,s).next(function(){return i._o.Yi(t,r.targetId)}).next(function(){return i._o.er(t,n,r.targetId)}).next(function(){return i.wo.$s(t,e)})})]}})})}var Ic=function(){function t(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return t.prototype.ks=function(t,e){return bu.resolve(this.Vc.get(e))},t.prototype.Ms=function(t,e){var n;return this.Vc.set(e.id,{id:(n=e).id,version:n.version,createTime:Bs(n.createTime)}),bu.resolve()},t.prototype.Ls=function(t,e){return bu.resolve(this.bc.get(e))},t.prototype.$s=function(t,e){return this.bc.set(e.name,function(t){return{name:t.name,query:pa(t.bundledQuery),readTime:Bs(t.readTime)}}(e)),bu.resolve()},t}(),Ec=function(){function t(){this.vc=new ps(Oc.Sc),this.Dc=new ps(Oc.Cc)}return t.prototype.et=function(){return this.vc.et()},t.prototype.nr=function(t,e){var n=new Oc(t,e);this.vc=this.vc.add(n),this.Dc=this.Dc.add(n)},t.prototype.xc=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},t.prototype.ir=function(t,e){this.Nc(new Oc(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},t.prototype.Oc=function(t){var e=this,n=new si(new ri([])),r=new Oc(n,t),i=new Oc(n,t+1),o=[];return this.Dc.me([r,i],function(t){e.Nc(t),o.push(t.key)}),o},t.prototype.kc=function(){var t=this;this.vc.forEach(function(e){return t.Nc(e)})},t.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},t.prototype.Mc=function(t){var e=new si(new ri([])),n=new Oc(e,t),r=new Oc(e,t+1),i=Es();return this.Dc.me([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Oi=function(t){var e=new Oc(t,0),n=this.vc.Re(e);return null!==n&&t.isEqual(n.key)},t}(),Oc=function(){function t(t,e){this.key=t,this.Lc=e}return t.Sc=function(t,e){return si.H(t.key,e.key)||qr(t.Lc,e.Lc)},t.Cc=function(t,e){return qr(t.Lc,e.Lc)||si.H(t.key,e.key)},t}(),Tc=function(){function t(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.$c=1,this.Bc=new ps(Oc.Sc)}return t.prototype.Ai=function(t){return bu.resolve(0===this.zo.length)},t.prototype.Ri=function(t,e,n,r){var i=this.$c;this.$c++;var o=new ea(i,e,n,r);this.zo.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Bc=this.Bc.add(new Oc(a.key,i)),this.Ei.qs(t,a.key.path.X())}return bu.resolve(o)},t.prototype.Pi=function(t,e){return bu.resolve(this.qc(e))},t.prototype.gi=function(t,e){var n=this.Uc(e+1),r=n<0?0:n;return bu.resolve(this.zo.length>r?this.zo[r]:null)},t.prototype.Vi=function(){return bu.resolve(0===this.zo.length?-1:this.$c-1)},t.prototype.pi=function(t){return bu.resolve(this.zo.slice())},t.prototype.bi=function(t,e){var n=this,r=new Oc(e,0),i=new Oc(e,Number.POSITIVE_INFINITY),o=[];return this.Bc.me([r,i],function(t){var e=n.qc(t.Lc);o.push(e)}),bu.resolve(o)},t.prototype.vi=function(t,e){var n=this,r=new ps(qr);return e.forEach(function(t){var e=new Oc(t,0),i=new Oc(t,Number.POSITIVE_INFINITY);n.Bc.me([e,i],function(t){r=r.add(t.Lc)})}),bu.resolve(this.Qc(r))},t.prototype.Di=function(t,e){var n=e.path,r=n.length+1,i=n;si.wt(i)||(i=i.child(""));var o=new Oc(new si(i),0),s=new ps(qr);return this.Bc.Ae(function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(s=s.add(t.Lc)),!0)},o),bu.resolve(this.Qc(s))},t.prototype.Qc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.qc(t);null!==r&&n.push(r)}),n},t.prototype.Ci=function(t,e){var n=this;Rr(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return bu.forEach(e.mutations,function(i){var o=new Oc(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)}).next(function(){n.Bc=r})},t.prototype.xi=function(t){},t.prototype.Oi=function(t,e){var n=new Oc(e,0),r=this.Bc.Re(n);return bu.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return bu.resolve()},t.prototype.Kc=function(t,e){return this.Uc(t)},t.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},t.prototype.qc=function(t){var e=this.Uc(t);return e<0||e>=this.zo.length?null:this.zo[e]},t}(),jc=function(){function t(t,e){this.Ei=t,this.Wc=e,this.docs=new hs(si.H),this.size=0}return t.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:s,readTime:n}),this.size+=s-o,this.Ei.qs(t,r.path.X())},t.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype._i=function(t,e){var n=this.docs.get(e);return bu.resolve(n?n.hi:null)},t.prototype.getEntries=function(t,e){var n=this,r=gs();return e.forEach(function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)}),bu.resolve(r)},t.prototype.Kr=function(t,e,n){for(var r=ms(),i=new si(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.value,a=u.hi,c=u.readTime;if(!e.path.nt(s.key.path))break;c._(n)<=0||a instanceof Ui&&Io(e,a)&&(r=r.zt(a.key,a))}return bu.resolve(r)},t.prototype.jc=function(t,e){return bu.forEach(this.docs,function(t){return e(t)})},t.prototype.Nr=function(t){return new Nc(this)},t.prototype.kr=function(t){return bu.resolve(this.size)},t}(),Nc=function(t){function e(e){var n=this;return(n=t.call(this)||this).jr=e,n}return Object(jr.c)(e,t),e.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach(function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)}),bu.Ln(n)},e.prototype.fi=function(t,e){return this.jr._i(t,e)},e.prototype.di=function(t,e){return this.jr.getEntries(t,e)},e}(Ta),Ac=function(){function t(t){this.persistence=t,this.Gc=new Oa(function(t){return Gi(t)},Bi),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Ec,this.targetCount=0,this.Jc=Pa.Li()}return t.prototype.In=function(t,e){return this.Gc.forEach(function(t,n){return e(n)}),bu.resolve()},t.prototype.Qi=function(t){return bu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ki=function(t){return bu.resolve(this.zc)},t.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),bu.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),bu.resolve()},t.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new Pa(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},t.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,bu.resolve()},t.prototype.Hi=function(t,e){return this.Gi(e),bu.resolve()},t.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Oc(e.targetId),this.targetCount-=1,bu.resolve()},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gc.delete(s),o.push(r.Yi(t,u.targetId)),i++)}),bu.Ln(o).next(function(){return i})},t.prototype.Zi=function(t){return bu.resolve(this.targetCount)},t.prototype.tr=function(t,e){var n=this.Gc.get(e)||null;return bu.resolve(n)},t.prototype.er=function(t,e,n){return this.Hc.xc(e,n),bu.resolve()},t.prototype.sr=function(t,e,n){this.Hc.Fc(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach(function(e){i.push(r.Ni(t,e))}),bu.Ln(i)},t.prototype.Yi=function(t,e){return this.Hc.Oc(e),bu.resolve()},t.prototype.rr=function(t,e){var n=this.Hc.Mc(e);return bu.resolve(n)},t.prototype.Oi=function(t,e){return bu.resolve(this.Hc.Oi(e))},t}(),Sc=function(){function t(t,e){var n=this;this.Yc={},this.so=new $r(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Ac(this),this.Ei=new ga,this.fo=function(t,e){return new jc(t,function(t){return n.Ti.Xc(t)})}(this.Ei),this.Qt=new ra(e),this.wo=new Ic(this.Qt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Mo=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Po=function(){},t.prototype.yo=function(){},t.prototype.Ko=function(){return this.Ei},t.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new Tc(this.Ei,this.Ti),this.Yc[t.A()]=e),e},t.prototype.Sr=function(){return this._o},t.prototype.Fr=function(){return this.fo},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new xc(this.so.next());return this.Ti.Zc(),n(i).next(function(t){return r.Ti.ta(i).next(function(){return t})}).kn().then(function(t){return i.Vs(),t})},t.prototype.ea=function(t,e){return bu.$n(Object.values(this.Yc).map(function(n){return function(){return n.Oi(t,e)}}))},t}(),xc=function(t){function e(e){var n=this;return(n=t.call(this)||this).bs=e,n}return Object(jr.c)(e,t),e}(Du),Dc=function(){function t(t){this.persistence=t,this.na=new Ec,this.sa=null}return t.ia=function(e){return new t(e)},Object.defineProperty(t.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Lr()},enumerable:!1,configurable:!0}),t.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),bu.resolve()},t.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),bu.resolve()},t.prototype.Ni=function(t,e){return this.ra.add(e.toString()),bu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.na.Oc(e.targetId).forEach(function(t){return n.ra.add(t.toString())});var r=this.persistence.Sr();return r.rr(t,e.targetId).next(function(t){t.forEach(function(t){return n.ra.add(t.toString())})}).next(function(){return r.Ji(t,e)})},t.prototype.Zc=function(){this.sa=new Set},t.prototype.ta=function(t){var e=this,n=this.persistence.Fr().Nr();return bu.forEach(this.ra,function(r){var i=si._t(r);return e.oa(t,i).next(function(t){t||n.li(i)})}).next(function(){return e.sa=null,n.apply(t)})},t.prototype.Or=function(t,e){var n=this;return this.oa(t,e).next(function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())})},t.prototype.Xc=function(t){return 0},t.prototype.oa=function(t,e){var n=this;return bu.$n([function(){return bu.resolve(n.na.Oi(e))},function(){return n.persistence.Sr().Oi(t,e)},function(){return n.persistence.ea(t,e)}])},t}();function kc(t,e){return"firestore_clients_"+t+"_"+e}function Pc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.m()&&(r+="_"+e.uid),r}function Cc(t,e){return"firestore_targets_"+t+"_"+e}var Lc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ca=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Yr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(kr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Rc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ca=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Yr(r.error.code,r.error.message)),i?new t(e,r.state,o):(kr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Vc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ca=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ts(),s=0;i&&s<r.activeTargetIds.length;++s)i=wi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(kr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Uc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ca=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(kr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Mc=function(){function t(){this.activeTargetIds=Ts()}return t.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),qc=function(){function t(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.M=null,this.da=this.wa.bind(this),this.Ea=new hs(qr),this.Er=!1,this.Ta=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=kc(this.persistenceKey,this.la),this.ma=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ea=this.Ea.zt(this.la,new Mc),this.Aa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ya=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ga=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return t.Kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(jr.d)(this,function(f){switch(f.label){case 0:return[4,this._a.Uo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(kc(this.persistenceKey,r)))&&(o=Vc.ca(r,i))&&(this.Ea=this.Ea.zt(o.clientId,o));for(this.Va(),(s=this.storage.getItem(this.ya))&&(u=this.pa(s))&&this.ba(u),a=0,c=this.Ta;a<c.length;a++)this.wa(c[a]);return this.Ta=[],this.window.addEventListener("unload",function(){return h.Mo()}),this.Er=!0,[2]}})})},t.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},t.prototype.va=function(){return this.Sa(this.Ea)},t.prototype.Da=function(t){var e=!1;return this.Ea.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.Ca=function(t){this.xa(t,"pending")},t.prototype.Na=function(t,e,n){this.xa(t,e,n),this.Fa(t)},t.prototype.Oa=function(t){var e="not-current";if(this.Da(t)){var n=this.storage.getItem(Cc(this.persistenceKey,t));if(n){var r=Rc.ca(t,n);r&&(e=r.state)}}return this.ka.ua(t),this.Va(),e},t.prototype.Ma=function(t){this.ka.ha(t),this.Va()},t.prototype.La=function(t){return this.ka.activeTargetIds.has(t)},t.prototype.$a=function(t){this.removeItem(Cc(this.persistenceKey,t))},t.prototype.Ba=function(t,e,n){this.qa(t,e,n)},t.prototype.Ua=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.Ca(t)})},t.prototype.Qa=function(t){this.Ka(t)},t.prototype.Wa=function(){this.ja()},t.prototype.Mo=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Dr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ia)return void kr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po(function(){return Object(jr.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(jr.d)(this,function(u){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(e=this.Ha(n.key,n.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(r=this.Ja(n.key,n.newValue)))return[2,this.Ya(r)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(i=this.Xa(n.key,n.newValue)))return[2,this.Za(i)]}else if(n.key===this.ya){if(null!==n.newValue&&(o=this.pa(n.newValue)))return[2,this.ba(o)]}else if(n.key===this.ma)(s=function(t){var e=$r.q;if(null!=t)try{var n=JSON.parse(t);Rr("number"==typeof n),e=n}catch(t){kr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==$r.q&&this.M(s);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"ka",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),t.prototype.Va=function(){this.setItem(this.Ia,this.ka.aa())},t.prototype.xa=function(t,e,n){var r=new Lc(this.currentUser,t,e,n),i=Pc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.aa())},t.prototype.Fa=function(t){var e=Pc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ka=function(t){this.storage.setItem(this.ya,JSON.stringify({clientId:this.la,onlineState:t}))},t.prototype.qa=function(t,e,n){var r=Cc(this.persistenceKey,t),i=new Rc(t,e,n);this.setItem(r,i.aa())},t.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},t.prototype.Ga=function(t){var e=this.Aa.exec(t);return e?e[1]:null},t.prototype.Ha=function(t,e){var n=this.Ga(t);return Vc.ca(n,e)},t.prototype.Ja=function(t,e){var n=this.Ra.exec(t),r=Number(n[1]);return Lc.ca(new Qr(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Xa=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Rc.ca(r,e)},t.prototype.pa=function(t){return Uc.ca(t)},t.prototype.Ya=function(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},t.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._a.su(s,u).then(function(){n.Ea=r})},t.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},t.prototype.Sa=function(t){var e=Ts();return t.forEach(function(t,n){e=e.Pe(n.activeTargetIds)}),e},t}(),Fc=function(){function t(){this.iu=new Mc,this.ru={},this.fa=null,this.M=null}return t.prototype.Ca=function(t){},t.prototype.Na=function(t,e,n){},t.prototype.Oa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},t.prototype.Ba=function(t,e,n){this.ru[t]=e},t.prototype.Ma=function(t){this.iu.ha(t)},t.prototype.La=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.$a=function(t){delete this.ru[t]},t.prototype.va=function(){return this.iu.activeTargetIds},t.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.start=function(){return this.iu=new Mc,Promise.resolve()},t.prototype.Ua=function(t,e,n){},t.prototype.Qa=function(t){},t.prototype.Mo=function(){},t.prototype.B=function(t){},t.prototype.Wa=function(){},t}(),zc=function(){function t(){}return t.prototype.ou=function(t){},t.prototype.Mo=function(){},t}(),Gc=function(){function t(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return t.prototype.ou=function(t){this.lu.push(t)},t.prototype.Mo=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},t.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},t.prototype.au=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},t.prototype.hu=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},t.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Bc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Yc=function(){function t(t){this.fu=t.fu,this.du=t.du}return t.prototype.wu=function(t){this.Eu=t},t.prototype.Tu=function(t){this.Iu=t},t.prototype.onMessage=function(t){this.mu=t},t.prototype.close=function(){this.du()},t.prototype.send=function(t){this.fu(t)},t.prototype.Au=function(){this.Eu()},t.prototype.Ru=function(t){this.Iu(t)},t.prototype.Pu=function(t){this.mu(t)},t}(),Hc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(jr.c)(e,t),e.prototype.Su=function(t,e,n,r){return new Promise(function(i,o){var s=new Tr;s.listenOnce(Ir.COMPLETE,function(){try{switch(s.getLastErrorCode()){case _r.NO_ERROR:var e=s.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case _r.TIMEOUT:Dr("Connection",'RPC "'+t+'" timed out'),o(new Yr(Br.DEADLINE_EXCEEDED,"Request time out"));break;case _r.HTTP_ERROR:var n=s.getStatus();if(Dr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Br).indexOf(e)>=0?e:Br.UNKNOWN}(r.status);o(new Yr(u,r.message))}else o(new Yr(Br.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Yr(Br.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{Dr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.Cu=function(t,e){var n=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new yr,i=be(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(o.initMessageHeaders,e),Object(E.l)()||Object(E.n)()||Object(E.j)()||Object(E.k)()||Object(E.o)()||Object(E.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Dr("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Yc({fu:function(t){c?Dr("Connection","Not sending because WebChannel is closed:",t):(a||(Dr("Connection","Opening WebChannel transport."),u.open(),a=!0),Dr("Connection","WebChannel sending:",t),u.send(t))},du:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,Or.EventType.OPEN,function(){c||Dr("Connection","WebChannel transport opened.")}),f(u,Or.EventType.CLOSE,function(){c||(c=!0,Dr("Connection","WebChannel transport closed"),h.Ru())}),f(u,Or.EventType.ERROR,function(t){c||(c=!0,Pr("Connection","WebChannel transport errored:",t),h.Ru(new Yr(Br.UNAVAILABLE,"The operation could not be completed")))}),f(u,Or.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Rr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Dr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=rs[t];if(void 0!==e)return cs(e)}(i),s=r.message;void 0===o&&(o=Br.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Ru(new Yr(o,s)),u.close()}else Dr("Connection","WebChannel received:",n),h.Pu(n)}}),f(i,Er.STAT_EVENT,function(t){10===t.stat?Dr("Connection","Detected buffering proxy"):11===t.stat&&Dr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Au()},0),h},e}(function(){function t(t){this.yu=t,this.t=t.t,this.gu=(t.ssl?"https":"http")+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);Dr("RestConnection","Sending: ",i,n);var o={};return this.vu(o,r),this.Su(t,i,o,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(e){throw Pr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},t.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.6",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},t.prototype.bu=function(t,e){return this.gu+"/v1/"+e+":"+Bc[t]},t}());function Qc(){return"undefined"!=typeof window?window:null}function Kc(){return"undefined"!=typeof document?document:null}function Xc(t){return new qs(t,!0)}var Wc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.Fu=i,this.Ou=0,this.ku=null,this.Mu=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ou=0},t.prototype.Lu=function(){this.Ou=this.Fu},t.prototype.$u=function(t){var e=this;this.cancel();var n=Math.floor(this.Ou+this.Bu()),r=Math.max(0,Date.now()-this.Mu),i=Math.max(0,n-r);i>0&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ou+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ku=this.Zr.Tr(this.fs,i,function(){return e.Mu=Date.now(),t()}),this.Ou*=this.Nu,this.Ou<this.xu&&(this.Ou=this.xu),this.Ou>this.Fu&&(this.Ou=this.Fu)},t.prototype.qu=function(){null!==this.ku&&(this.ku.Rs(),this.ku=null)},t.prototype.cancel=function(){null!==this.ku&&(this.ku.cancel(),this.ku=null)},t.prototype.Bu=function(){return(Math.random()-.5)*this.Ou},t}(),Jc=function(){function t(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Wc(t,e)}return t.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Hu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ju()},t.prototype.stop=function(){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Yu=function(){this.state=0,this.Gu.reset()},t.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},t.prototype.th=function(t){this.eh(),this.stream.send(t)},t.prototype.Zu=function(){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},t.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},t.prototype.close=function(t,e){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===Br.RESOURCE_EXHAUSTED?(kr(e.toString()),kr("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Lu()):e&&e.code===Br.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}})})},t.prototype.nh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then(function(e){t.Wu===n&&t.ih(e)},function(n){e(function(){var e=new Yr(Br.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)})})},t.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.Tu(function(t){n(function(){return e.rh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Ju=function(){var t=this;this.state=4,this.Gu.$u(function(){return Object(jr.b)(t,void 0,void 0,function(){return Object(jr.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.rh=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps(function(){return e.Wu===t?n():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Zc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Qt=i,s}return Object(jr.c)(e,t),e.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},e.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Lr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Bt?(Rr(void 0===e||"string"==typeof e),Gr.fromBase64String(e||"")):(Rr(void 0===e||e instanceof Uint8Array),Gr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?Br.UNKNOWN:cs(t.code);return new Yr(e,t.message||"")}(u);n=new Ps(r,i,o,s||null)}else if("documentChange"in e){i=Ks(t,(r=e.documentChange).document.name),o=Bs(r.document.updateTime);var u=new Ci({mapValue:{fields:r.document.fields}}),a=(s=new Ui(i,o,u,{}),r.targetIds||[]);n=new Ds(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Ks(t,(r=e.documentDelete).document),o=r.readTime?Bs(r.readTime):ei.min(),u=new Mi(i,o),n=new Ds([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=Ks(t,(r=e.documentRemove).document),n=new Ds([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Lr();var c=e.filter;i=new us(r=c.count||0),n=new ks(o=c.targetId,i)}return n}(this.Qt,t),n=function(t){if(!("targetChange"in t))return ei.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ei.min():e.readTime?Bs(e.readTime):ei.min()}(t);return this.listener.ah(e,n)},e.prototype.uh=function(t){var e={};e.database=Js(this.Qt),e.addTarget=function(t,e){var n,r=e.target;return(n=Yi(r)?{documents:ru(t,r)}:{query:iu(t,r)}).targetId=e.targetId,e.resumeToken.l()>0?n.resumeToken=zs(t,e.resumeToken):e.kt._(ei.min())>0&&(n.readTime=Fs(t,e.kt.j())),n}(this.Qt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}(0,e.Ot);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.th(e)},e.prototype.hh=function(t){var e={};e.database=Js(this.Qt),e.removeTarget=t,this.th(e)},e}(Jc),$c=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Qt=i,s.lh=!1,s}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.nh=function(){this.lh&&this.fh([])},e.prototype.oh=function(t){return this.Qu.Cu("Write",t)},e.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=function(t,e){return t&&t.length>0?(Rr(void 0!==e),t.map(function(t){return function(t,e){var n=Bs(t.updateTime?t.updateTime:e);n.isEqual(ei.min())&&(n=Bs(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new zo(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Bs(t.commitTime);return this.listener.dh(n,e)}return Rr(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},e.prototype.Eh=function(){var t={};t.database=Js(this.Qt),this.th(t)},e.prototype.fh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return eu(e.Qt,t)})};this.th(n)},e}(Jc),th=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qu=n,i.Qt=r,i.Th=!1,i}return Object(jr.c)(e,t),e.prototype.Ih=function(){if(this.Th)throw new Yr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then(function(i){return r.Qu.pu(t,e,n,i)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&r.credentials.p(),t})},e.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then(function(i){return r.Qu.Du(t,e,n,i)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&r.credentials.p(),t})},e.prototype.terminate=function(){this.Th=!1},e}(function(){}),eh=function(){function t(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return t.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},t.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},t.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},t.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},t.prototype.gh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(kr(e),this.Rh=!1):Dr("OnlineStateTracker",e)},t.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},t}(),nh=function(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.Fh=[],this.Oh=i,this.Oh.ou(function(t){n.Ps(function(){return Object(jr.b)(o,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return fh(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(jr.b)(this,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return(e=Vr(t)).Nh.add(4),[4,ih(e)];case 1:return n.sent(),e.kh.set("Unknown"),e.Nh.delete(4),[4,rh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.kh=new eh(n,r)};function rh(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n;return Object(jr.d)(this,function(r){switch(r.label){case 0:if(!fh(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ih(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n;return Object(jr.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function oh(t,e){var n=Vr(t);n.xh.has(e.targetId)||(n.xh.set(e.targetId,e),hh(n)?ch(n):jh(n).Hu()&&uh(n,e))}function sh(t,e){var n=Vr(t),r=jh(n);n.xh.delete(e),r.Hu()&&ah(n,e),0===n.xh.size&&(r.Hu()?r.Xu():fh(n)&&n.kh.set("Unknown"))}function uh(t,e){t.Mh.on(e.targetId),jh(t).uh(e)}function ah(t,e){t.Mh.on(e),jh(t).hh(e)}function ch(t){t.Mh=new Ls({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),jh(t).start(),t.kh.Ph()}function hh(t){return fh(t)&&!jh(t).zu()&&t.xh.size>0}function fh(t){return 0===Vr(t).Nh.size}function lh(t){t.Mh=void 0}function ph(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){return t.xh.forEach(function(e,n){uh(t,e)}),[2]})})}function dh(t,e){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(n){return lh(t),hh(t)?(t.kh.Vh(e),ch(t)):t.kh.set("Unknown"),[2]})})}function vh(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o;return Object(jr.d)(this,function(s){switch(s.label){case 0:if(t.kh.set("Online"),!(e instanceof Ps&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(jr.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.xh.has(o=i[r])?[4,t.Dh.Lh(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.xh.delete(o),t.Mh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,yh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ds?t.Mh.dn(e):e instanceof ks?t.Mh.Pn(e):t.Mh.Tn(e),n.isEqual(ei.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,hc(t.bh)];case 8:return i=s.sent(),n._(i)>=0?[4,function(t,e){var n=t.Mh.Vn(e);return n.Fe.forEach(function(n,r){if(n.resumeToken.l()>0){var i=t.xh.get(r);i&&t.xh.set(r,i.Lt(n.resumeToken,e))}}),n.Oe.forEach(function(e){var n=t.xh.get(e);if(n){t.xh.set(e,n.Lt(Gr.T,n.kt)),ah(t,e);var r=new To(n.target,e,1,n.sequenceNumber);uh(t,r)}}),t.Dh.$h(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,yh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function yh(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r=this;return Object(jr.d)(this,function(i){switch(i.label){case 0:if(!Eu(e))throw e;return t.Nh.add(1),[4,ih(t)];case 1:return i.sent(),t.kh.set("Offline"),n||(n=function(){return hc(t.bh)}),t._s.po(function(){return Object(jr.b)(r,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,rh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function gh(t,e){return e().catch(function(n){return yh(t,n,e)})}function bh(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(jr.d)(this,function(s){switch(s.label){case 0:e=Vr(t),n=Nh(e),r=e.Ch.length>0?e.Ch[e.Ch.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return fh(t)&&t.Ch.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,pc(e.bh,r)];case 3:return null===(i=s.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=i.batchId,function(t,e){t.Ch.push(e);var n=Nh(t);n.Hu()&&n._h&&n.fh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,yh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return mh(e)&&wh(e),[2]}})})}function mh(t){return fh(t)&&!Nh(t).zu()&&t.Ch.length>0}function wh(t){Nh(t).start()}function _h(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){return Nh(t).Eh(),[2]})})}function Ih(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n,r;return Object(jr.d)(this,function(i){for(e=Nh(t),n=0,r=t.Ch;n<r.length;n++)e.fh(r[n].mutations);return[2]})})}function Eh(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return r=t.Ch.shift(),i=na.from(r,e,n),[4,gh(t,function(){return t.Dh.Bh(i)})];case 1:return o.sent(),[4,bh(t)];case 2:return o.sent(),[2]}})})}function Oh(t,e){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(n){switch(n.label){case 0:return e&&Nh(t)._h?[4,function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r;return Object(jr.d)(this,function(i){switch(i.label){case 0:return as(r=e.code)&&r!==Br.ABORTED?(n=t.Ch.shift(),Nh(t).Yu(),[4,gh(t,function(){return t.Dh.qh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,bh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return mh(t)&&wh(t),[2]}})})}function Th(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n;return Object(jr.d)(this,function(r){switch(r.label){case 0:return n=Vr(t),e?(n.Nh.delete(2),[4,rh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,ih(n)]);case 3:r.sent(),n.kh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function jh(t){var e=this;return t.Uh||(t.Uh=function(t,e,n){var r=Vr(t);return r.Ih(),new Zc(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:ph.bind(null,t),Tu:dh.bind(null,t),ah:vh.bind(null,t)}),t.Fh.push(function(n){return Object(jr.b)(e,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return n?(t.Uh.Yu(),hh(t)?ch(t):t.kh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:e.sent(),lh(t),e.label=3;case 3:return[2]}})})})),t.Uh}function Nh(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=Vr(t);return r.Ih(),new $c(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:_h.bind(null,t),Tu:Oh.bind(null,t),wh:Ih.bind(null,t),dh:Eh.bind(null,t)}),t.Fh.push(function(n){return Object(jr.b)(e,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Yu(),[4,bh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:e.sent(),t.Ch.length>0&&(Dr("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),e.label=4;case 4:return[2]}})})})),t.Qh}var Ah=function(){this.Kh=void 0,this.listeners=[]},Sh=function(){this.queries=new Oa(function(t){return wo(t)},mo),this.onlineState="Unknown",this.Wh=new Set};function xh(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(jr.d)(this,function(c){switch(c.label){case 0:if(n=Vr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Ah),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.jh(r)];case 2:return s.Kh=c.sent(),[3,4];case 3:return u=c.sent(),a=Su(u,"Initialization of query '"+_o(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Gh(n.onlineState),o.Kh&&e.zh(o.Kh)&&Ch(n),[2]}})})}function Dh(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(jr.d)(this,function(u){return n=Vr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]})})}function kh(t,e){for(var n=Vr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].zh(s)&&(r=!0);u.Kh=s}}r&&Ch(n)}function Ph(t,e,n){var r=Vr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Ch(t){t.Wh.forEach(function(t){t.next()})}var Lh=function(){function t(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new As(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},t.prototype.onError=function(t){this.Jh.error(t)},t.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},t.prototype.tl=function(t,e){return!t.fromCache||!(this.options.nl&&"Offline"!==e||t.docs.et()&&"Offline"!==e)},t.prototype.Zh=function(t){return t.docChanges.length>0||!!(t.Ce||this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.el=function(t){t=As.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},t}(),Rh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.sl=function(){return"metadata"in this.payload},t}(),Vh=function(){function t(t){this.Qt=t}return t.prototype.Pc=function(t){return Ks(this.Qt,t)},t.prototype.yc=function(t){return t.metadata.exists?tu(this.Qt,t.document,!1):new Mi(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},t.prototype.gc=function(t){return Bs(t)},t}();!function(){function t(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.ol=function(t){for(var e=new Map,n=new Vh(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Es()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return[4,wc(this.bh,new Vh(this.Qt),this.documents,this.il.id)];case 1:t=o.sent(),e=this.ol(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,_c(this.bh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new nc(Object.assign({},this.progress),t))]}})})}}();var Uh=function(t){this.key=t},Mh=function(t){this.key=t},qh=function(){function t(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=Es(),this.De=Es(),this.hl=Eo(t),this.ll=new js(this.hl)}return Object.defineProperty(t.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),t.prototype.fl=function(t,e){var n=this,r=e?e.dl:new Ns,i=e?e.ll:this.ll,o=e?e.De:this.De,s=i,u=!1,a=ho(this.query)&&i.size===this.query.limit?i.last():null,c=fo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt(function(t,e){var h=i.get(t),f=e instanceof Ui?e:null;f&&(f=Io(n.query,f)?f:null);var l=!!h&&n.De.has(h.key),p=!!f&&(f.Vt||n.De.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.wl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.hl(f,a)>0||c&&n.hl(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),ho(this.query)||fo(this.query))for(;s.size>this.query.limit;){var h=ho(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ll:s,dl:r,lc:u,De:o}},t.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},t.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}};return n(t)-n(e)}(t.type,e.type)||r.hl(t.doc,e.doc)}),this.El(n);var s=e?this.Tl():[],u=0===this.ul.size&&this.Be?1:0,a=u!==this.al;return this.al=u,0!==o.length||a?{snapshot:new As(this.query,t.ll,i,o,t.De,0===u,a,!1),Il:s}:{Il:s}},t.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new Ns,De:this.De,lc:!1},!1)):{Il:[]}},t.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},t.prototype.El=function(t){var e=this;t&&(t.qe.forEach(function(t){return e.cl=e.cl.add(t)}),t.Ue.forEach(function(t){}),t.Qe.forEach(function(t){return e.cl=e.cl.delete(t)}),this.Be=t.Be)},t.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=Es(),this.ll.forEach(function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))});var n=[];return e.forEach(function(e){t.ul.has(e)||n.push(new Mh(e))}),this.ul.forEach(function(t){e.has(t)||n.push(new Uh(t))}),n},t.prototype.Al=function(t){this.cl=t.Rc,this.ul=Es();var e=this.fl(t.documents);return this.wi(e,!0)},t.prototype.Rl=function(){return As.Ne(this.query,this.ll,this.De,0===this.al)},t}(),Fh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},zh=function(t){this.key=t,this.Pl=!1},Gh=function(){function t(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Oa(function(t){return wo(t)},mo),this.Sl=new Map,this.Dl=[],this.Cl=new hs(si.H),this.xl=new Map,this.Nl=new Ec,this.Fl={},this.Ol=new Map,this.kl=Pa.$i(),this.onlineState="Unknown",this.Ml=void 0}return Object.defineProperty(t.prototype,"Ll",{get:function(){return!0===this.Ml},enumerable:!1,configurable:!0}),t}();function Bh(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:return n=wf(t),(i=n.vl.get(e))?(n.Vl.Oa(i.targetId),r=i.view.Rl(),[3,4]):[3,1];case 1:return[4,dc(n.bh,go(e))];case 2:return o=u.sent(),s=n.Vl.Oa(o.targetId),[4,Yh(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.Ll&&oh(n.yl,o),u.label=4;case 4:return[2,r]}})})}function Yh(t,e,n,r){return Object(jr.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(jr.d)(this,function(h){switch(h.label){case 0:return t.$l=function(e,n,r){return function(t,e,n,r){return Object(jr.b)(this,void 0,void 0,function(){var i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:return(i=e.view.fl(n)).lc?[4,yc(t.bh,e.query,!1).then(function(t){return e.view.fl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.wi(i,t.Ll,o),[2,(of(t,e.targetId,s.Il),s.snapshot)]}})})}(t,e,n,r)},[4,yc(t.bh,e,!0)];case 1:return i=h.sent(),o=new qh(e,i.Rc),s=o.fl(i.documents),u=xs.$e(n,r&&"Offline"!==t.onlineState),a=o.wi(s,t.Ll,u),of(t,n,a.Il),c=new Fh(e,n,o),[2,(t.vl.set(e,c),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),a.snapshot)]}})})}function Hh(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return n=Vr(t),r=n.vl.get(e),(i=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,i.filter(function(t){return!mo(t,e)})),void n.vl.delete(e))]:n.Ll?(n.Vl.Ma(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,vc(n.bh,r.targetId,!1).then(function(){n.Vl.$a(r.targetId),sh(n.yl,r.targetId),nf(n,r.targetId)}).catch(Ea)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return nf(n,r.targetId),[4,vc(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Qh(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:r=_f(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Vr(t),i=ti.now(),o=e.reduce(function(t,e){return t.add(e.key)},Es());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Tc.Xo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Ko(c,n.get(c.key));null!=h&&s.push(new Zo(c.key,h,Ri(h.proto.mapValue),Go.exists(!0)))}return r.zo.Ri(t,i,s,e)})}).then(function(t){var e=t.xs(n);return{batchId:t.batchId,ri:e}})}(r.bh,e)];case 2:return i=u.sent(),r.Vl.Ca(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.A()];r||(r=new hs(qr)),r=r.zt(e,n),t.Fl[t.currentUser.A()]=r}(r,i.batchId,n),[4,af(r,i.ri)];case 3:return u.sent(),[4,bh(r.yl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Su(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Kh(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r;return Object(jr.d)(this,function(i){switch(i.label){case 0:n=Vr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,fc(n.bh,e)];case 2:return r=i.sent(),e.Fe.forEach(function(t,e){var r=n.xl.get(e);r&&(Rr(t.qe.size+t.Ue.size+t.Qe.size<=1),t.qe.size>0?r.Pl=!0:t.Ue.size>0?Rr(r.Pl):t.Qe.size>0&&(Rr(r.Pl),r.Pl=!1))}),[4,af(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ea(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Xh(t,e,n){var r=Vr(t);if(r.Ll&&0===n||!r.Ll&&1===n){var i=[];r.vl.forEach(function(t,n){var r=n.view.Gh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Vr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Gh(e)&&(r=!0)}),r&&Ch(n)}(r.gl,e),i.length&&r.bl.ah(i),r.onlineState=e,r.Ll&&r.Vl.Qa(e)}}function Wh(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(jr.d)(this,function(c){switch(c.label){case 0:return(r=Vr(t)).Vl.Ba(e,"rejected",n),i=r.xl.get(e),(o=i&&i.key)?(s=(s=new hs(si.H)).zt(o,new Mi(o,ei.min())),u=Es().add(o),a=new Ss(ei.min(),new Map,new ps(qr),s,u),[4,Kh(r,a)]):[3,2];case 1:return c.sent(),r.Cl=r.Cl.remove(o),r.xl.delete(e),uf(r),[3,4];case 2:return[4,vc(r.bh,e,!1).then(function(){return nf(r,e,n)}).catch(Ea)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Jh(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:n=Vr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,cc(n.bh,e)];case 2:return i=o.sent(),ef(n,r,null),tf(n,r),n.Vl.Na(r,"acknowledged"),[4,af(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ea(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Zh(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:r=Vr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Vr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.zo.Pi(t,e).next(function(e){return Rr(null!==e),r=e.keys(),n.zo.Ci(t,e)}).next(function(){return n.zo.Fi(t)}).next(function(){return n.Tc.Xo(t,r)})})}(r.bh,e)];case 2:return i=o.sent(),ef(r,e,n),tf(r,e),r.Vl.Na(e,"rejected",n),[4,af(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ea(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function $h(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:fh((n=Vr(t)).yl)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Vr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zo.Vi(t)})}(n.bh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Ol.get(r)||[]).push(e),n.Ol.set(r,i),[3,4]);case 3:return o=u.sent(),s=Su(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function tf(t,e){(t.Ol.get(e)||[]).forEach(function(t){t.resolve()}),t.Ol.delete(e)}function ef(t,e,n){var r=Vr(t),i=r.Fl[r.currentUser.A()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.A()]=i}}function nf(t,e,n){void 0===n&&(n=null),t.Vl.Ma(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ll&&t.Nl.Oc(e).forEach(function(e){t.Nl.Oi(e)||rf(t,e)})}function rf(t,e){var n=t.Cl.get(e);null!==n&&(sh(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),uf(t))}function of(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Uh?(t.Nl.nr(o.key,e),sf(t,o)):o instanceof Mh?(Dr("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Oi(o.key)||rf(t,o.key)):Lr()}}function sf(t,e){var n=e.key;t.Cl.get(n)||(Dr("SyncEngine","New document in limbo: "+n),t.Dl.push(n),uf(t))}function uf(t){for(;t.Dl.length>0&&t.Cl.size<t.pl;){var e=t.Dl.shift(),n=t.kl.next();t.xl.set(n,new zh(e)),t.Cl=t.Cl.zt(e,n),oh(t.yl,new To(go(co(e.path)),n,2,$r.q))}}function af(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:return r=Vr(t),i=[],o=[],s=[],r.vl.et()?[3,3]:(r.vl.forEach(function(t,u){s.push(r.$l(u,e,n).then(function(t){if(t){r.Ll&&r.Vl.Ba(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=ic.oc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.bl.ah(i),[4,function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(jr.d)(this,function(h){switch(h.label){case 0:n=Vr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return bu.forEach(e,function(e){return bu.forEach(e.ic,function(r){return n.persistence.Ti.nr(t,e.targetId,r)}).next(function(){return bu.forEach(e.rc,function(r){return n.persistence.Ti.ir(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Eu(r=h.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.fc.get(u),c=a.$t(a.kt),n.fc=n.fc.zt(u,c));return[2]}})})}(r.bh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function cf(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r;return Object(jr.d)(this,function(i){switch(i.label){case 0:return(n=Vr(t)).currentUser.isEqual(e)?[3,3]:(Dr("SyncEngine","User change. New user:",e.A()),[4,ac(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Ol.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Br.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Ol.clear()}(n),n.Vl.Ua(e,r.mc,r.Ac),[4,af(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function hf(t,e){var n=Vr(t),r=n.xl.get(e);if(r&&r.Pl)return Es().add(r.key);var i=Es(),o=n.Sl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.vl.get(u[s]);i=i.Pe(a.view._l)}return i}function ff(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return[4,yc((n=Vr(t)).bh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Al(r),[2,(n.Ll&&of(n,e.targetId,i.Il),i)]}})})}function lf(t){return Object(jr.b)(this,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){return[2,bc((e=Vr(t)).bh).then(function(t){return af(e,t)})]})})}function pf(t,e,n,r){return Object(jr.b)(this,void 0,void 0,function(){var i,o;return Object(jr.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Vr(t),r=Vr(n.zo);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.yi(t,e).next(function(e){return e?n.Tc.Xo(t,e):bu.resolve(null)})})}((i=Vr(t)).bh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,bh(i.yl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(ef(i,e,r||null),tf(i,e),function(t,e){Vr(Vr(t).zo).xi(e)}(i.bh,e)):Lr(),s.label=4;case 4:return[4,af(i,o)];case 5:return s.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function df(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(jr.d)(this,function(c){switch(c.label){case 0:return wf(n=Vr(t)),_f(n),!0!==e||!0===n.Ml?[3,3]:(r=n.Vl.va(),[4,vf(n,r.it())]);case 1:return i=c.sent(),n.Ml=!0,[4,Th(n.yl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)oh(n.yl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ml?[3,7]:(u=[],a=Promise.resolve(),n.Sl.forEach(function(t,e){n.Vl.La(e)?u.push(e):a=a.then(function(){return nf(n,e),vc(n.bh,e,!0)}),sh(n.yl,e)}),[4,a]);case 4:return c.sent(),[4,vf(n,u)];case 5:return c.sent(),function(t){var e=Vr(t);e.xl.forEach(function(t,n){sh(e.yl,n)}),e.Nl.kc(),e.xl=new Map,e.Cl=new hs(si.H)}(n),n.Ml=!1,[4,Th(n.yl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function vf(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(jr.d)(this,function(v){switch(v.label){case 0:n=Vr(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Sl.get(u=s[o]))&&0!==c.length?[4,dc(n.bh,go(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.vl.get(f[h]),[4,ff(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,gc(n.bh,u)];case 8:return d=v.sent(),[4,dc(n.bh,d)];case 9:return a=v.sent(),[4,Yh(n,yf(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.bl.ah(i),r)]}})})}function yf(t){return ao(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function gf(t){var e=Vr(t);return Vr(Vr(e.bh).persistence).Uo()}function bf(t,e,n,r){return Object(jr.b)(this,void 0,void 0,function(){var i,o,s;return Object(jr.d)(this,function(u){switch(u.label){case 0:return(i=Vr(t)).Ml?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,bc(i.bh)];case 3:return o=u.sent(),s=Ss.Le(e,"current"===n),[4,af(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,vc(i.bh,e,!0)];case 6:return u.sent(),nf(i,e,r),[3,8];case 7:Lr(),u.label=8;case 8:return[2]}})})}function mf(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(jr.d)(this,function(l){switch(l.label){case 0:if(!(r=wf(t)).Ml)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Sl.has(s=o[i])?(Dr("SyncEngine","Adding an already active target "+s),[3,5]):[4,gc(r.bh,s)]:[3,6];case 2:return u=l.sent(),[4,dc(r.bh,u)];case 3:return a=l.sent(),[4,Yh(r,yf(u),a.targetId,!1)];case 4:l.sent(),oh(r.yl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(jr.d)(this,function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,vc(r.bh,t,!1).then(function(){sh(r.yl,t),nf(r,t)}).catch(Ea)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function wf(t){var e=Vr(t);return e.yl.Dh.$h=Kh.bind(null,e),e.yl.Dh.vn=hf.bind(null,e),e.yl.Dh.Lh=Wh.bind(null,e),e.bl.ah=kh.bind(null,e.gl),e.bl.Bl=Ph.bind(null,e.gl),e}function _f(t){var e=Vr(t);return e.yl.Dh.Bh=Jh.bind(null,e),e.yl.Dh.qh=Zh.bind(null,e),e}var If=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return this.Qt=Xc(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}})})},t.prototype.zl=function(t){return null},t.prototype.Hl=function(t){return uc(this.persistence,new oc,t.Jl,this.Qt)},t.prototype.jl=function(t){return new Sc(Dc.ia,this.Qt)},t.prototype.Wl=function(t){return new Fc},t.prototype.terminate=function(){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.Mo()];case 1:return t.sent(),[4,this.persistence.Mo()];case 2:return t.sent(),[2]}})})},t}(),Ef=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Yl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(jr.c)(e,t),e.prototype.initialize=function(e){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,mc(this.bh)];case 2:return n.sent(),[4,this.Yl.initialize(this,e)];case 3:return n.sent(),[4,_f(this.Yl._a)];case 4:return n.sent(),[4,bh(this.Yl.yl)];case 5:return n.sent(),[2]}})})},e.prototype.Hl=function(t){return uc(this.persistence,new oc,t.Jl,this.Qt)},e.prototype.zl=function(t){return new qa(this.persistence.Ti.lr,t._s)},e.prototype.jl=function(t){var e=ec(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?Ia.Ys(this.cacheSizeBytes):Ia.ti;return new Za(this.synchronizeTabs,e,t.clientId,n,t._s,Qc(),Kc(),this.Qt,this.Vl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new Fc},e}(If),Of=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Yl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(jr.c)(e,t),e.prototype.initialize=function(e){return Object(jr.b)(this,void 0,void 0,function(){var n,r=this;return Object(jr.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Yl._a,this.Vl instanceof qc?(this.Vl._a={eu:pf.bind(null,n),nu:bf.bind(null,n),su:mf.bind(null,n),Uo:gf.bind(null,n),tu:lf.bind(null,n)},[4,this.Vl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Ro(function(t){return Object(jr.b)(r,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return[4,df(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Wl=function(t){var e=Qc();if(!qc.Kn(e))throw new Yr(Br.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ec(t.yu.t,t.yu.persistenceKey);return new qc(e,t._s,n,t.clientId,t.Jl)},e}(Ef),Tf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n=this;return Object(jr.d)(this,function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return Xh(n._a,t,1)},this.yl.Dh.n_=cf.bind(null,this._a),[4,Th(this.yl,this._a.Ll)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.t_=function(t){return new Sh},t.prototype.Xl=function(t){var e=Xc(t.yu.t),n=new Hc(t.yu);return function(t,e,n){return new th(t,e,n)}(t.credentials,n,e)},t.prototype.Zl=function(t){var e,n,r,i,o,s=this;return e=this.bh,n=this.Sh,r=t._s,i=function(t){return Xh(s._a,t,0)},o=Gc.Kn()?new Gc:new zc,new nh(e,n,r,i,o)},t.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Gh(t,e,n,r,i,o);return s&&(u.Ml=!0),u}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},t.prototype.terminate=function(){return function(t){return Object(jr.b)(this,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return e=Vr(t),Dr("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,ih(e)];case 1:return n.sent(),e.Oh.Mo(),e.kh.set("Unknown"),[2]}})})}(this.yl)},t}(),jf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.i_=function(){this.muted=!0},t.prototype.s_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Nf=(function(){function t(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new gu,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then(function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.r_.cancel()},t.prototype.getMetadata=function(){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Ql=function(){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}})})},t.prototype.c_=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(jr.d)(this,function(i){switch(i.label){case 0:return[4,this.a_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.o_.decode(t),n=Number(e),isNaN(n)&&this.u_("length string ("+e+") is not valid number"),[4,this.h_(n)]);case 2:return r=i.sent(),[2,new Rh(JSON.parse(r),t.length+n)]}})})},t.prototype.l_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.a_=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.h_=function(t){return Object(jr.b)(this,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.__()]:[3,3];case 1:n.sent()&&this.u_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.__=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return[4,this.r_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Yr(Br.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new oi(t)}return t.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},t}()),Af=function(t){this._methodName=t},Sf=function(t){this.d_=t};function xf(t,e,n){if(!n)throw new Yr(Br.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Df(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Br.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function kf(t,e,n,r){if(!0===e&&!0===r)throw new Yr(Br.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Pf(t){if(!si.wt(t))throw new Yr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Cf(t){if(si.wt(t))throw new Yr(Br.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Lf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Lr()}function Rf(t,e){if("_delegate"in t&&(t=t.d_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Yr(Br.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Lf(t);throw new Yr(Br.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Vf(t,e){if(e<=0)throw new Yr(Br.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Uf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Br.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Yr(Br.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,kf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Mf=new Map,qf=function(){function t(t,e){this.w_="(lite)",this.E_=new Uf({}),this.T_=!1,t instanceof Ar?(this.I_=t,this.m_=new Xr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Yr(Br.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ar(t.options.projectId)}(t),this.m_=new Wr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new Yr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new Yr(Br.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Uf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Xr;switch(t.type){case"gapi":var e=t.client;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Yr(Br.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},t.prototype.b_=function(){return(t=Mf.get(this))&&(Dr("ComponentProvider","Removing Datastore"),Mf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Ff=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Gf(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),zf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Gf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,co(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new Ff(this.firestore,null,new si(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(zf);function Bf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Sf&&(t=t.d_),xf("collection","path",e),t instanceof qf)return Cf(n=ri.ot.apply(ri,Object(jr.g)([e],r))),new Gf(t,null,n);if(!(t instanceof Ff||t instanceof Gf))throw new Yr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Cf(n=ri.ot.apply(ri,Object(jr.g)([t.path],r)).child(ri.ot(e))),new Gf(t.firestore,null,n)}function Yf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Sf&&(t=t.d_),1===arguments.length&&(e=Mr.u()),xf("doc","path",e),t instanceof qf)return Pf(n=ri.ot.apply(ri,Object(jr.g)([e],r))),new Ff(t,null,new si(n));if(!(t instanceof Ff||t instanceof Gf))throw new Yr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Pf(n=t.D_.child(ri.ot.apply(ri,Object(jr.g)([e],r)))),new Ff(t.firestore,t instanceof Gf?t.v_:null,new si(n))}function Hf(t,e){return t instanceof Sf&&(t=t.d_),e instanceof Sf&&(e=e.d_),(t instanceof Ff||t instanceof Gf)&&(e instanceof Ff||e instanceof Gf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Qf(t,e){return t instanceof Sf&&(t=t.d_),e instanceof Sf&&(e=e.d_),t instanceof zf&&e instanceof zf&&t.firestore===e.firestore&&mo(t.C_,e.C_)&&t.v_===e.v_}var Kf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Yr(Br.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Yr(Br.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.U=function(t){return qr(this.x_,t.x_)||qr(this.N_,t.N_)},t}(),Xf=/^__.*__$/,Wf=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Gt?new Zo(t,this.data,this.Gt,e,this.fieldTransforms):new Jo(t,this.data,e,this.fieldTransforms)},t}(),Jf=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Zo(t,this.data,this.Gt,e,this.fieldTransforms)},t}();function Zf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Lr()}}var $f=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return ml(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Gt.find(function(e){return t.nt(e)})||void 0!==this.fieldTransforms.find(function(e){return t.nt(e.field)})},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Zf(this.k_)&&Xf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),tl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Xc(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new $f({k_:t,methodName:e,j_:n,path:oi.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},t}();function el(t){var e=t.p_(),n=Xc(t.I_);return new tl(t.I_,!!e.ignoreUndefinedProperties,n)}function nl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);vl("Data must be an object, but it was:",s,r);var u,a,c=pl(r,s);if(o.merge)u=new hi(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=yl(e,l[f],n);if(!s.contains(p))throw new Yr(Br.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");wl(h,p)||h.push(p)}u=new hi(h),a=s.fieldTransforms.filter(function(t){return u.Tt(t.field)})}else u=null,a=s.fieldTransforms;return new Wf(new Ci(c),u,a)}var rl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Af);function il(t,e,n){return new $f({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var ol=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.z_=function(t){return new Fo(t.path,new Po)},e.prototype.isEqual=function(t){return t instanceof e},e}(Af),sl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(jr.c)(e,t),e.prototype.z_=function(t){var e=il(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),r=new Co(n);return new Fo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Af),ul=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(jr.c)(e,t),e.prototype.z_=function(t){var e=il(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),r=new Ro(n);return new Fo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Af),al=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(jr.c)(e,t),e.prototype.z_=function(t){var e=new Uo(t.Qt,Ao(t.Qt,this.J_));return new Fo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Af);function cl(t,e,n,r){var i=t.G_(1,e,n);vl("Data must be an object, but it was:",i,r);var o=[],s=new Li;ai(r,function(t,r){var u=bl(e,t,n);r instanceof Sf&&(r=r.d_);var a=i.U_(u);if(r instanceof rl)o.push(u);else{var c=ll(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new hi(o);return new Jf(s.Pt(),u,i.fieldTransforms)}function hl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[yl(e,r,n)],a=[i];if(o.length%2!=0)throw new Yr(Br.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(yl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Li,l=u.length-1;l>=0;--l)if(!wl(h,u[l])){var p=u[l],d=a[l];d instanceof Sf&&(d=d.d_);var v=s.U_(p);if(d instanceof rl)h.push(p);else{var y=ll(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new hi(h);return new Jf(f.Pt(),g,s.fieldTransforms)}function fl(t,e,n,r){return void 0===r&&(r=!1),ll(n,t.G_(r?4:3,e))}function ll(t,e){if(t instanceof Sf&&(t=t.d_),dl(t))return vl("Unsupported field value:",e,t),pl(t,e);if(t instanceof Af)return function(t,e){if(!Zf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ll(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Sf&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ao(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:Fs(e.Qt,n)}}if(t instanceof ti)return n=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Fs(e.Qt,n)};if(t instanceof Kf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Hr)return{bytesValue:zs(e.Qt,t.I)};if(t instanceof Ff){var r=t.firestore.I_;if(!r.isEqual(n=e.t))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ys(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+Lf(t))}(t,e)}function pl(t,e){var n={};return ci(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):ai(t,function(t,r){var i=ll(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function dl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof Kf||t instanceof Hr||t instanceof Ff||t instanceof Af)}function vl(t,e,n){if(!dl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Lf(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function yl(t,e,n){if(e instanceof Sf&&(e=e.d_),e instanceof Nf)return e.f_;if("string"==typeof e)return bl(t,e);throw ml("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var gl=new RegExp("[~\\*/\\[\\]]");function bl(t,e,n){if(e.search(gl)>=0)throw ml("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Nf.bind.apply(Nf,Object(jr.g)([void 0],e.split("."))))).f_}catch(r){throw ml("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ml(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Yr(Br.INVALID_ARGUMENT,(u+=". ")+t+a)}function wl(t,e){return t.some(function(t){return t.isEqual(e)})}var _l=function(){function t(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n=this;return Object(jr.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new Yr(Br.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(jr.d)(this,function(a){switch(a.label){case 0:return n=Vr(t),r=Js(n.Qt)+"/documents",i={documents:e.map(function(t){return Qs(n.Qt,t)})},[4,n.Du("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Rr(!!e.found);var n=Ks(t,e.found.name),r=Bs(e.found.updateTime),i=new Ci({mapValue:{fields:e.found.fields}});return new Ui(n,r,i,{})}(t,e):"missing"in e?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);var n=Ks(t,e.missing),r=Bs(e.readTime);return new Mi(n,r)}(t,e):Lr()}(n.Qt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Rr(!!e),u.push(e)}),u)]}})})}(this.Sh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Mi||t instanceof Ui?n.sf(t):Lr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new os(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e=this;return Object(jr.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=si._t(n);e.mutations.push(new ss(r,e.jt(r)))}),[4,function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return n=Vr(t),r=Js(n.Qt)+"/documents",i={writes:e.map(function(t){return eu(n.Qt,t)})},[4,n.pu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof Ui)e=t.version;else{if(!(t instanceof Mi))throw Lr();e=ei.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Br.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Go.updateTime(e):Go.Kt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(ei.min()))throw new Yr(Br.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Go.updateTime(e)}return Go.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Il=function(){function t(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Wc(this._s,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.Gu.$u(function(){return Object(jr.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(jr.d)(this,function(r){return t=new _l(this.Sh),(e=this.uf(t))&&e.then(function(e){n._s.Ps(function(){return t.commit().then(function(){n.Es.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!bi(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps(function(){return e.af(),Promise.resolve()})):this.Es.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!as(e)}return!1},t}(),El=function(){function t(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Qr.UNAUTHENTICATED,this.clientId=Mr.u(),this._f=function(){},this.C=new gu,this.credentials.v(function(t){Dr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()})}return t.prototype.getConfiguration=function(){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this._s.wf)throw new Yr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this._s.Ef();var e=new gu;return this._s.Tf(function(){return Object(jr.b)(t,void 0,void 0,function(){var t,n;return Object(jr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Su(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Ol(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(jr.d)(this,function(o){switch(o.label){case 0:return t._s.Af(),Dr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Jl,t.ff(function(n){r.isEqual(n)||(r=n,t._s.po(function(){return Object(jr.b)(i,void 0,void 0,function(){return Object(jr.d)(this,function(t){switch(t.label){case 0:return[4,ac(e.bh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.Po(function(){return t.terminate()}),t.mf=e,[2]}})})}function Tl(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r;return Object(jr.d)(this,function(i){switch(i.label){case 0:return t._s.Af(),[4,jl(t)];case 1:return n=i.sent(),Dr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t._s.po(function(){return function(t,e){return Object(jr.b)(this,void 0,void 0,function(){var n,r;return Object(jr.d)(this,function(i){switch(i.label){case 0:return(n=Vr(t))._s.Af(),Dr("RemoteStore","RemoteStore received new credentials"),r=fh(n),n.Nh.add(3),[4,ih(n)];case 1:return i.sent(),r&&n.kh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,rh(n)];case 3:return i.sent(),[2]}})})}(e.yl,n)})}),t.If=e,[2]}})})}function jl(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(Dr("FirestoreClient","Using default OfflineComponentProvider"),[4,Ol(t,new If)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function Nl(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(Dr("FirestoreClient","Using default OnlineComponentProvider"),[4,Tl(t,new Tf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function Al(t){return jl(t).then(function(t){return t.persistence})}function Sl(t){return jl(t).then(function(t){return t.bh})}function xl(t){return Nl(t).then(function(t){return t.yl})}function Dl(t){return Nl(t).then(function(t){return t._a})}function kl(t){return Object(jr.b)(this,void 0,void 0,function(){var e,n;return Object(jr.d)(this,function(r){switch(r.label){case 0:return[4,Nl(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=Bh.bind(null,e._a),n.Hh=Hh.bind(null,e._a),n)]}})})}function Pl(t,e,n){var r=this;void 0===n&&(n={});var i=new gu;return t._s.Ps(function(){return Object(jr.b)(r,void 0,void 0,function(){var r;return Object(jr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new jf({next:function(o){e.Ps(function(){return Dh(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Yr(Br.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Yr(Br.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Lh(co(n.path),o,{includeMetadataChanges:!0,nl:!0});return xh(t,s)},[4,kl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}})})}),i.promise}function Cl(t,e,n){var r=this;void 0===n&&(n={});var i=new gu;return t._s.Ps(function(){return Object(jr.b)(r,void 0,void 0,function(){var r;return Object(jr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new jf({next:function(n){e.Ps(function(){return Dh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Yr(Br.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Lh(n,o,{includeMetadataChanges:!0,nl:!0});return xh(t,s)},[4,kl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}})})}),i.promise}var Ll=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Wc(this,"async_queue_retry"),this.vf=function(){var e=Kc();e&&Dr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=Kc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ps=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Kc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.po=function(t){var e=this;this.Ps(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(jr.b)(this,void 0,void 0,function(){var t,e=this;return Object(jr.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!Eu(t=n.sent()))throw t;return Dr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.$u(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,kr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Tr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Au.Ts(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&Lr()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(jr.b)(this,void 0,void 0,function(){var t;return Object(jr.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ds-e.ds});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}();function Rl(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this.Mf={},this.Lf=new gu,this.$f={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Mf={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Lf.promise.catch(t)},t.prototype.then=function(t,e){return this.Lf.promise.then(t,e)},t.prototype.ql=function(t){this.Ul(t),this.Mf.complete&&this.Mf.complete(),this.Lf.resolve(t)},t.prototype.Kl=function(t){this.$f.taskState="Error",this.Mf.next&&this.Mf.next(this.$f),this.Mf.error&&this.Mf.error(t),this.Lf.reject(t)},t.prototype.Ul=function(t){this.$f=t,this.Mf.next&&this.Mf.next(t)}}();var Vl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Bf=new Ll,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(jr.c)(e,t),e.prototype.b_=function(){return this.qf||Ml(this),this.qf.terminate()},e}(qf);function Ul(t){return t.qf||Ml(t),t.qf.df(),t.qf}function Ml(t){var e=t.p_(),n=function(t,e,n){return new Nr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.qf=new El(t.m_,t.Bf,n)}function ql(t,e,n){var r=this,i=new gu;return t._s.enqueue(function(){return Object(jr.b)(r,void 0,void 0,function(){var r;return Object(jr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Ol(t,n)];case 1:return o.sent(),[4,Tl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Br.FAILED_PRECONDITION||t.code===Br.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Fl(t){if(t.R_||t.P_)throw new Yr(Br.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var zl=function(){function t(){}return t.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),_i(t)){case 0:return null;case 1:return t.booleanValue;case 2:return pi(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(di(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Lr()}},t.prototype.Hf=function(t,e){var n=this,r={};return ai(t.fields||{},function(t,i){r[t]=n.Uf(i,e)}),r},t.prototype.Gf=function(t){return new Kf(pi(t.latitude),pi(t.longitude))},t.prototype.zf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Uf(t,e)})},t.prototype.Kf=function(t,e){switch(e){case"previous":var n=yi(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(gi(t));default:return null}},t.prototype.Qf=function(t){var e=li(t);return new ti(e.seconds,e.nanos)},t.prototype.Jf=function(t,e){var n=ri.ot(t);Rr(yu(n));var r=new Ar(n.get(1),n.get(3)),i=new si(n.Y(5));return r.isEqual(e)||kr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Gl=function(){function t(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ff(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Zf},t.prototype.data=function(){if(this.Zf){if(this.v_){var t=new Bl(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},t.prototype.get=function(t){if(this.Zf){var e=this.Zf.data().field(Yl("DocumentSnapshot.get",t));if(null!==e)return this.Xf.Uf(e)}},t}(),Bl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Gl);function Yl(t,e){return"string"==typeof e?bl(t,e):e instanceof Sf?e.d_.f_:e.f_}function Hl(t){if(fo(t)&&0===t.xt.length)throw new Yr(Br.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ql=function(){};function Kl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.td(t)}return t}var Xl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).ed=e,i.nd=n,i.sd=r,i.type="where",i}return Object(jr.c)(e,t),e.prototype.td=function(t){var e=el(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ut()){if("array-contains"===o||"array-contains-any"===o)throw new Yr(Br.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){np(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(ep(r,t,h[c]));u={arrayValue:{values:a}}}else u=ep(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||np(s,o),u=fl(n,"where",s,"in"===o||"not-in"===o);var f=Hi.create(i,o,u);return function(t,e){if(e.Ct()){var n=po(t);if(null!==n&&!n.isEqual(e.field))throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=lo(t);null!==r&&rp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Yr(Br.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.ed,this.nd,this.sd);return new zf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new uo(t.path,t.collectionGroup,t.xt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Ql),Wl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ed=e,r.rd=n,r.type="orderBy",r}return Object(jr.c)(e,t),e.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ro(e,n);return function(t,e){if(null===lo(t)){var n=po(t);null!==n&&rp(0,n,e.field)}}(t,r),r}(t.C_,this.ed,this.rd);return new zf(t.firestore,t.v_,function(t,e){var n=t.xt.concat([e]);return new uo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Ql),Jl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.od=n,i.ad=r,i}return Object(jr.c)(e,t),e.prototype.td=function(t){return new zf(t.firestore,t.v_,bo(t.C_,this.od,this.ad))},e}(Ql),Zl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return Object(jr.c)(e,t),e.prototype.td=function(t){var e=tp(t,this.type,this.ud,this.hd);return new zf(t.firestore,t.v_,function(t,e){return new uo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Ql),$l=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return Object(jr.c)(e,t),e.prototype.td=function(t){var e=tp(t,this.type,this.ud,this.hd);return new zf(t.firestore,t.v_,function(t,e){return new uo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Ql);function tp(t,e,n,r){if(n[0]instanceof Sf&&(n[0]=n[0].d_),n[0]instanceof Gl)return function(t,e,n,r,i){if(!r)throw new Yr(Br.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=yo(t);s<u.length;s++){var a=u[s];if(a.field.ut())o.push(Ai(e,r.key));else{var c=r.field(a.field);if(vi(c))throw new Yr(Br.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.rt();throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new eo(o,i)}(t.C_,t.firestore.I_,e,n[0].Zf,r);var i=el(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Yr(Br.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!vo(t)&&-1!==c.indexOf("/"))throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ri.ot(c));if(!si.wt(h))throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new si(h);u.push(Ai(e,f))}else{var l=fl(n,r,c);u.push(l)}}return new eo(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function ep(t,e,n){if(n instanceof Sf&&(n=n.d_),"string"==typeof n){if(""===n)throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!vo(e)&&-1!==n.indexOf("/"))throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ri.ot(n));if(!si.wt(r))throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ai(t,new si(r))}if(n instanceof Ff)return Ai(t,n.S_);throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Lf(n)+".")}function np(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Br.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Yr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function rp(t,e,n){if(!n.isEqual(e))throw new Yr(Br.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ip(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var op=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(jr.c)(e,t),e.prototype.Wf=function(t){return new Hr(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new Ff(this.firestore,null,e)},e}(zl),sp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),up=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).Yf=e,u.ld=e,u.metadata=o,u}return Object(jr.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new ap(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){var n=this.Zf.data().field(Yl("DocumentSnapshot.get",t));if(null!==n)return this.Xf.Uf(n,e.serverTimestamps)}},e}(Gl),ap=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(up),cp=function(){function t(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new sp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach(function(r){t.call(e,new ap(n.Yf,n.Xf,r.key,r,new sp(n._d.De.has(r.key),n._d.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._d.xe)throw new Yr(Br.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===e||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map(function(e){return{type:"added",doc:new ap(t.Yf,t.Xf,e.doc.key,e.doc,new sp(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t._d.Se;return t._d.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new ap(t.Yf,t.Xf,e.doc.key,e.doc,new sp(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:hp(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.dd=e),this.fd},t}();function hp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}function fp(t,e){return t instanceof up&&e instanceof up?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof cp&&e instanceof cp&&t.Yf===e.Yf&&Qf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var lp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(jr.c)(e,t),e.prototype.Wf=function(t){return new Hr(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new Ff(this.firestore,null,e)},e}(zl);function pp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Rf(t,Ff);var o=Rf(t.firestore,Vl),s=el(o);return e instanceof Sf&&(e=e.d_),vp(o,[("string"==typeof e||e instanceof Nf?hl(s,"updateDoc",t.S_,e,n,r):cl(s,"updateDoc",t.S_,e)).F_(t.S_,Go.exists(!0))])}function dp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Sf&&(t=t.d_);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Rl(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Rl(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Ff)c=Rf(t.firestore,Vl),h=co(t.S_.path),a={next:function(e){i[u]&&i[u](yp(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Rf(t,zf);c=Rf(p.firestore,Vl),h=p.C_;var d=new lp(c);a={next:function(t){i[u]&&i[u](new cp(c,d,p,t))},error:i[u+1],complete:i[u+2]},Hl(t.C_)}return function(t,e,n,r){var i=this,o=new jf(r),s=new Lh(e,o,n);return t._s.Ps(function(){return Object(jr.b)(i,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return e=xh,[4,kl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.i_(),t._s.Ps(function(){return Object(jr.b)(i,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return e=Dh,[4,kl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Ul(c),h,f,a)}function vp(t,e){return function(t,e){var n=this,r=new gu;return t._s.Ps(function(){return Object(jr.b)(n,void 0,void 0,function(){var n;return Object(jr.d)(this,function(i){switch(i.label){case 0:return n=Qh,[4,Dl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Ul(t),e)}function yp(t,e,n){var r=n.docs.get(e.S_),i=new lp(t);return new up(t,i,e.S_,r,new sp(n.hasPendingWrites,n.fromCache),e.v_)}var gp=function(){function t(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=el(t)}return t.prototype.set=function(t,e,n){this.md();var r=bp(t,this.Yf),i=ip(r.v_,e,n),o=nl(this.Id,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.Ed.push(o.F_(r.S_,Go.Kt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();var o,s=bp(t,this.Yf);return e instanceof Sf&&(e=e.d_),o="string"==typeof e||e instanceof Nf?hl(this.Id,"WriteBatch.update",s.S_,e,n,r):cl(this.Id,"WriteBatch.update",s.S_,e),this.Ed.push(o.F_(s.S_,Go.exists(!0))),this},t.prototype.delete=function(t){this.md();var e=bp(t,this.Yf);return this.Ed=this.Ed.concat(new os(e.S_,Go.Kt())),this},t.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Td)throw new Yr(Br.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function bp(t,e){if(t instanceof Sf&&(t=t.d_),t.firestore!==e)throw new Yr(Br.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var mp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Yf=e,r}return Object(jr.c)(e,t),e.prototype.get=function(e){var n=this,r=bp(e,this.Yf),i=new lp(this.Yf);return t.prototype.get.call(this,e).then(function(t){return new up(n.Yf,i,r.S_,t.Zf,new sp(!1,!1),r.v_)})},e}(function(){function t(t,e){this.Yf=t,this.Ad=e,this.Id=el(t)}return t.prototype.get=function(t){var e=this,n=bp(t,this.Yf),r=new op(this.Yf);return this.Ad.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Lr();var i=t[0];if(i instanceof Mi)return new Gl(e.Yf,r,n.S_,null,n.v_);if(i instanceof Ui)return new Gl(e.Yf,r,i.key,i,n.v_);throw Lr()})},t.prototype.set=function(t,e,n){var r=bp(t,this.Yf),i=ip(r.v_,e,n),o=nl(this.Id,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Ad.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=bp(t,this.Yf);return e instanceof Sf&&(e=e.d_),o="string"==typeof e||e instanceof Nf?hl(this.Id,"Transaction.update",s.S_,e,n,r):cl(this.Id,"Transaction.update",s.S_,e),this.Ad.update(s.S_,o),this},t.prototype.delete=function(t){var e=bp(t,this.Yf);return this.Ad.delete(e.S_),this},t}());function wp(){if("undefined"==typeof Uint8Array)throw new Yr(Br.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function _p(){if("undefined"==typeof atob)throw new Yr(Br.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ip=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.fromBase64String=function(t){return _p(),new e(Hr.fromBase64String(t))},e.fromUint8Array=function(t){return wp(),new e(Hr.fromUint8Array(t))},e.prototype.toBase64=function(){return _p(),this.d_.toBase64()},e.prototype.toUint8Array=function(){return wp(),this.d_.toUint8Array()},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Sf),Ep=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Fl(t=Rf(t,Vl));var n=Ul(t),r=t.p_(),i=new Tf;return ql(n,i,new Ef(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Fl(t=Rf(t,Vl));var e=Ul(t),n=t.p_(),r=new Tf;return ql(e,r,new Of(r,n.cacheSizeBytes))}(t.d_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Yr(Br.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new gu;return t.Bf.Tf(function(){return Object(jr.b)(e,void 0,void 0,function(){var e;return Object(jr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(jr.b)(this,void 0,void 0,function(){return Object(jr.d)(this,function(e){switch(e.label){case 0:return wu.Kn()?[4,wu.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(ec(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.d_)},t}(),Op=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Rd=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Ar||(i.Pd=e),i}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Rf(t,qf)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&Pr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this.d_,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue(function(){return Object(jr.b)(e,void 0,void 0,function(){var e,n;return Object(jr.d)(this,function(r){switch(r.label){case 0:return[4,Al(t)];case 1:return e=r.sent(),[4,xl(t)];case 2:return n=r.sent(),[2,(e.yo(!0),function(t){var e=Vr(t);return e.Nh.delete(0),rh(e)}(n))]}})})})}(Ul(Rf(this.d_,Vl)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue(function(){return Object(jr.b)(e,void 0,void 0,function(){var e,n;return Object(jr.d)(this,function(r){switch(r.label){case 0:return[4,Al(t)];case 1:return e=r.sent(),[4,xl(t)];case 2:return n=r.sent(),[2,(e.yo(!1),function(t){return Object(jr.b)(this,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return(e=Vr(t)).Nh.add(0),[4,ih(e)];case 1:return n.sent(),e.kh.set("Offline"),[2]}})})}(n))]}})})})}(Ul(Rf(this.d_,Vl)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&kf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new gu;return t._s.Ps(function(){return Object(jr.b)(e,void 0,void 0,function(){var e;return Object(jr.d)(this,function(r){switch(r.label){case 0:return e=$h,[4,Dl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Ul(Rf(this.d_,Vl)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new jf(e);return t._s.Ps(function(){return Object(jr.b)(n,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Vr(t).Wh.add(e),e.next()},[4,kl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.i_(),t._s.Ps(function(){return Object(jr.b)(n,void 0,void 0,function(){var e;return Object(jr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Vr(t).Wh.delete(e)},[4,kl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Ul(t=Rf(t,Vl)),Rl(e)?e:{next:e})}(this.d_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Pd)throw new Yr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Up(this,Bf(this.d_,t))}catch(t){throw xp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Sp(this,Yf(this.d_,t))}catch(t){throw xp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Lp(this,function(t,e){if(t=Rf(t,qf),xf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Yr(Br.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new zf(t,null,function(t){return new uo(ri.ct(),t)}(e))}(this.d_,t))}catch(t){throw xp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new gu;return t._s.Ps(function(){return Object(jr.b)(n,void 0,void 0,function(){var n;return Object(jr.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Nl(t).then(function(t){return t.Sh})}(t)];case 1:return n=i.sent(),new Il(t._s,n,e,r).run(),[2]}})})}),r.promise}(Ul(t),function(n){return e(new mp(t,n))})}(this.d_,function(n){return t(new jp(e,n))})},e.prototype.batch=function(){var t=this;return Ul(this.d_),new Np(new gp(this.d_,function(e){return vp(t.d_,e)}))},e.prototype.loadBundle=function(t){throw new Yr(Br.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Yr(Br.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Sf),Tp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(jr.c)(e,t),e.prototype.Wf=function(t){return new Ip(new Hr(t))},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return Sp.yd(e,this.firestore,null)},e}(zl),jp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r.Xf=new Tp(e),r}return Object(jr.c)(e,t),e.prototype.get=function(t){var e=this,n=Mp(t);return this.d_.get(n).then(function(t){return new Pp(e.Yf,new up(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=Mp(t);return n?(Df("Transaction.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Mp(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,Object(jr.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Mp(t);return this.d_.delete(e),this},e}(Sf),Np=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.set=function(t,e,n){var r=Mp(t);return n?(Df("WriteBatch.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Mp(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,Object(jr.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Mp(t);return this.d_.delete(e),this},e.prototype.commit=function(){return this.d_.commit()},e}(Sf),Ap=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).Yf=e,i.Xf=n,i}return Object(jr.c)(e,t),e.prototype.fromFirestore=function(t,e){var n=new ap(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new Cp(this.Yf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},e.gd=function(t,n){var r=e.Vd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new Tp(t),n),i.set(n,o)),o},e}(Sf);Ap.Vd=new WeakMap;var Sp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new Tp(e),r}return Object(jr.c)(e,t),e.pd=function(t,n,r){if(t.length%2!=0)throw new Yr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new e(n,new Ff(n.d_,r,new si(t)))},e.yd=function(t,n,r){return new e(n,new Ff(n.d_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Up(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Up(this.firestore,Bf(this.d_,t))}catch(t){throw xp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Sf&&(t=t.d_),t instanceof Ff&&Hf(this.d_,t)},e.prototype.set=function(t,e){e=Df("DocumentReference.set",e);try{return function(t,e,n){t=Rf(t,Ff);var r=Rf(t.firestore,Vl),i=ip(t.v_,e,n);return vp(r,[nl(el(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Go.Kt())])}(this.d_,t,e)}catch(t){throw xp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?pp(this.d_,t):pp.apply(void 0,Object(jr.g)([this.d_,t,e],n))}catch(t){throw xp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return vp(Rf((t=this.d_).firestore,Vl),[new os(t.S_,Go.Kt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dp(e),i=kp(e,function(e){return new Pp(t.firestore,new up(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))});return dp(this.d_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Rf(t,Ff);var e=Rf(t.firestore,Vl),n=Ul(e),r=new lp(e);return function(t,e){var n=this,r=new gu;return t._s.Ps(function(){return Object(jr.b)(n,void 0,void 0,function(){var n;return Object(jr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i;return Object(jr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Vr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Tc.Ho(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof Ui?n.resolve(i):i instanceof Mi?n.resolve(null):n.reject(new Yr(Br.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Su(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Sl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new up(e,r,t.S_,n,new sp(n instanceof Ui&&n.Vt,!0),t.v_)})}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=Rf(t,Ff);var e=Rf(t.firestore,Vl);return Pl(Ul(e),t.S_,{source:"server"}).then(function(n){return yp(e,t,n)})}(this.d_):function(t){t=Rf(t,Ff);var e=Rf(t.firestore,Vl);return Pl(Ul(e),t.S_).then(function(n){return yp(e,t,n)})}(this.d_)).then(function(t){return new Pp(e.firestore,new up(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(Ap.gd(this.firestore,t)))},e}(Sf);function xp(t,e,n){return t.message=t.message.replace(e,n),t}function Dp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Rl(r))return r}return{}}function kp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Rl(t[0])?t[0]:Rl(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Sp(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.d_.data(t)},e.prototype.get=function(t,e){return this.d_.get(t,e)},e.prototype.isEqual=function(t){return fp(this.d_,t.d_)},e}(Sf),Cp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.prototype.data=function(t){return this.d_.data(t)},e}(Pp),Lp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new Tp(e),r}return Object(jr.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Kl(this.d_,function(t,e,n){var r=e,i=Yl("where",t);return new Xl(i,r,n)}(t,n,r)))}catch(t){throw xp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Kl(this.d_,function(t,e){void 0===e&&(e="asc");var n=e,r=Yl("orderBy",t);return new Wl(r,n)}(t,n)))}catch(t){throw xp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Kl(this.d_,function(t){return Vf("limit",t),new Jl("limit",t,"F")}(t)))}catch(t){throw xp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Kl(this.d_,function(t){return Vf("limitToLast",t),new Jl("limitToLast",t,"L")}(t)))}catch(t){throw xp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Kl(this.d_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zl("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw xp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Kl(this.d_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zl("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw xp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Kl(this.d_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $l("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw xp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Kl(this.d_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $l("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw xp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Qf(this.d_,t.d_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Rf(t,zf);var e=Rf(t.firestore,Vl),n=Ul(e),r=new lp(e);return function(t,e){var n=this,r=new gu;return t._s.Ps(function(){return Object(jr.b)(n,void 0,void 0,function(){var n;return Object(jr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(jr.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(jr.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,yc(t,e,!0)];case 1:return u=a.sent(),r=new qh(e,u.Rc),i=r.fl(u.documents),o=r.wi(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=Su(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,Sl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new cp(e,r,t,n)})}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=Rf(t,zf);var e=Rf(t.firestore,Vl),n=Ul(e),r=new lp(e);return Cl(n,t.C_,{source:"server"}).then(function(n){return new cp(e,r,t,n)})}(this.d_):function(t){t=Rf(t,zf);var e=Rf(t.firestore,Vl),n=Ul(e),r=new lp(e);return Hl(t.C_),Cl(n,t.C_).then(function(n){return new cp(e,r,t,n)})}(this.d_)).then(function(t){return new Vp(e.firestore,new cp(e.firestore.d_,e.Xf,e.d_,t._d))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dp(e),i=kp(e,function(e){return new Vp(t.firestore,new cp(t.firestore.d_,t.Xf,t.d_,e._d))});return dp(this.d_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(Ap.gd(this.firestore,t)))},e}(Sf),Rp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Cp(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),e}(Sf),Vp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Lp(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map(function(e){return new Cp(t.Yf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map(function(t){return new Rp(e.Yf,t)})},e.prototype.forEach=function(t,e){var n=this;this.d_.forEach(function(r){t.call(e,new Cp(n.Yf,r))})},e.prototype.isEqual=function(t){return fp(this.d_,t.d_)},e}(Sf),Up=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.d_=n,r}return Object(jr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new Sp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Sp(this.firestore,void 0===t?Yf(this.d_):Yf(this.d_,t))}catch(t){throw xp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Rf(t.firestore,Vl),r=Yf(t),i=ip(t.v_,e);return vp(n,[nl(el(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Go.exists(!1))]).then(function(){return r})}(this.d_,t).then(function(t){return new Sp(e.firestore,t)})},e.prototype.isEqual=function(t){return Hf(this.d_,t.d_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(Ap.gd(this.firestore,t)))},e}(Lp);function Mp(t){return t instanceof Sf&&(t=t.d_),Rf(t,Ff)}var qp,Fp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Nf.bind.apply(Nf,Object(jr.g)([void 0],e))))||this}return Object(jr.c)(e,t),e.documentId=function(){return new e(oi.ht().rt())},e.prototype.isEqual=function(t){return t instanceof Sf&&(t=t.d_),t instanceof Nf&&this.d_.f_.isEqual(t.f_)},e}(Sf),zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(jr.c)(e,t),e.serverTimestamp=function(){var t=new ol("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new rl("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sl("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ul("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new al("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e}(Sf),Gp=n("/6Yf"),Bp={Firestore:Op,GeoPoint:Kf,Timestamp:ti,Blob:Ip,Transaction:jp,WriteBatch:Np,DocumentReference:Sp,DocumentSnapshot:Pp,Query:Lp,QueryDocumentSnapshot:Cp,QuerySnapshot:Vp,CollectionReference:Up,FieldPath:Fp,FieldValue:zp,setLogLevel:function(t){Sr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Gp.a("firestore",function(t){return function(t,e){return new Op(t,new Vl(t,e),new Ep)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Bp)))})(qp=_.a),qp.registerVersion("@firebase/firestore","2.1.5");var Yp=n("UbJi");function Hp(t,e){return function(t,e=i.b){return new o.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Qp(t,e){return Hp(t,e).pipe(Object(p.a)(t=>({payload:t,type:"query"})))}function Kp(t,e){return Qp(t,e).pipe(Object(a.a)(void 0),h(),Object(p.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function Xp(t,e,n){return Kp(t,n).pipe(Object(d.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return Wp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Wp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Wp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(v.a)(),Object(p.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Wp(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function Jp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class Zp{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Kp(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(p.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(a.a)(void 0),h(),Object(y.a)(([t,e])=>e.length>0||!t),Object(p.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(d.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Jp(t);return Xp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(s.a)(this.query.get(t)).pipe(Object(g.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new $p(this.ref.doc(t),this.afs)}}class $p{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=od(n,e);return new Zp(r,i,this.afs)}snapshotChanges(){return Hp(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(a.a)(void 0),h(),Object(p.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(p.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(s.a)(this.ref.get(t)).pipe(Object(g.b)(this.afs.schedulers.insideAngular))}}class td{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Kp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(y.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Kp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(d.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Jp(t);return Xp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(s.a)(this.query.get(t)).pipe(Object(g.b)(this.afs.schedulers.insideAngular))}}const ed=new r.r("angularfire2.enableFirestorePersistence"),nd=new r.r("angularfire2.firestore.persistenceSettings"),rd=new r.r("angularfire2.firestore.settings"),id=new r.r("angularfire2.firestore.use-emulator");function od(t,e=(t=>t)){return{query:e(t),ref:t}}let sd=(()=>{class t{constructor(t,e,n,r,i,o,a,c,h){this.schedulers=new b.d(o),this.keepUnstableUntilFirst=Object(b.h)(this.schedulers);const f=Object(b.g)(t,o,e);!w.a.auth&&h&&Object(b.j)();const l=c;[this.firestore,this.persistenceEnabled$]=Object(b.f)(`${f.name}.firestore`,"AngularFirestore",f,()=>{const t=o.runOutsideAngular(()=>f.firestore());if(r&&t.settings(r),l&&t.useEmulator(...l),n&&!Object(m.w)(i)){const e=()=>{try{return Object(s.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(qp){return"undefined"!=typeof console&&console.warn(qp),Object(u.a)(!1)}};return[t,o.runOutsideAngular(e)]}return[t,Object(u.a)(!1)]},[r,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=od(n,e),o=this.schedulers.ngZone.run(()=>r);return new Zp(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new td(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new $p(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(r.Yb(b.c),r.Yb(b.b,8),r.Yb(ed,8),r.Yb(rd,8),r.Yb(r.C),r.Yb(r.A),r.Yb(nd,8),r.Yb(id,8),r.Yb(Yp.b,8))},t.\u0275prov=Object(r.Ib)({factory:function(){return new t(Object(r.Yb)(b.c),Object(r.Yb)(b.b,8),Object(r.Yb)(ed,8),Object(r.Yb)(rd,8),Object(r.Yb)(r.C),Object(r.Yb)(r.A),Object(r.Yb)(nd,8),Object(r.Yb)(id,8),Object(r.Yb)(Yp.b,8))},token:t,providedIn:"any"}),t})()}}]);